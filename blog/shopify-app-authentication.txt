2:I[9275,[],""]
3:I[1343,[],""]
4:I[231,["231","static/chunks/231-bea070b1ecddfbbc.js","768","static/chunks/app/blog/layout-a90c7b1536f7eb16.js"],""]
0:["O3-Q5fdoqPKXD7w66aJ6n",[[["",{"children":["blog",{"children":["shopify-app-authentication",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":["shopify-app-authentication",{"children":["__PAGE__",{},[["$L1",[["$","nav",null,{"className":"toc","children":["$","ol",null,{"className":"toc-level toc-level-1","children":[["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#giới-thiệu","children":"Giới thiệu"}]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#shopify-oauth-flow","children":"Shopify OAuth Flow"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#overview","children":"Overview"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#chi-tiết-từng-bước","children":"Chi tiết từng bước"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#implementation-với-shopify-app-remix","children":"Implementation với Shopify App Remix"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#shopifyserverts-configuration","children":"shopify.server.ts Configuration"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#session-storage-options","children":"Session Storage Options"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#scopes---quyền-truy-cập-app","children":"Scopes - Quyền truy cập App"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#scopes-phổ-biến","children":"Scopes phổ biến"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#best-practices","children":"Best Practices"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#sử-dụng-authentication-trong-routes","children":"Sử dụng Authentication trong Routes"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#protected-routes-admin-ui","children":"Protected Routes (Admin UI)"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#public-api-routes","children":"Public API Routes"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#webhook-authentication","children":"Webhook Authentication"}]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#security-best-practices","children":"Security Best Practices"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#1-environment-variables","children":"1. Environment Variables"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#2-https-cho-production","children":"2. HTTPS cho Production"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#3-session-validation","children":"3. Session Validation"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#4-rate-limiting","children":"4. Rate Limiting"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#real-world-example","children":"Real-world Example"}]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#testing-authentication","children":"Testing Authentication"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#test-với-development-store","children":"Test với Development Store"}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#test-session-expiry","children":"Test Session Expiry"}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":[["$","a",null,{"className":"toc-link toc-link-h2","href":"#common-issues","children":"Common Issues"}],["$","ol",null,{"className":"toc-level toc-level-2","children":[["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#issue-invalid-hmac-signature","children":"Issue: \"Invalid HMAC signature\""}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#issue-session-not-found","children":"Issue: \"Session not found\""}]}],["$","li",null,{"className":"toc-item toc-item-h3","children":["$","a",null,{"className":"toc-link toc-link-h3","href":"#issue-access-denied","children":"Issue: \"Access denied\""}]}]]}]]}],["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#key-takeaways","children":"Key Takeaways"}]}],["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#tài-nguyên-tham-khảo","children":"Tài nguyên tham khảo"}]}],["$","li",null,{"className":"toc-item toc-item-h2","children":["$","a",null,{"className":"toc-link toc-link-h2","href":"#next-steps","children":"Next Steps"}]}]]}]}],"\n",["$","h1",null,{"id":"authentication--authorization-trong-shopify-app","children":"Authentication & Authorization trong Shopify App"}],"\n",["$","h2",null,{"id":"giới-thiệu","children":"Giới thiệu"}],"\n",["$","p",null,{"children":"Authentication là hàng rào bảo vệ đầu tiên cho Shopify App của bạn. Bài viết này sẽ giải thích cách Shopify OAuth hoạt động và cách implement secure authentication."}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"shopify-oauth-flow","children":"Shopify OAuth Flow"}],"\n",["$","h3",null,{"id":"overview","children":"Overview"}],"\n",["$","p",null,{"children":"Khi merchant cài đặt app của bạn, Shopify sẽ redirect họ qua app để xác thực quyền truy cập."}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"mermaid","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"mermaid","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"sequenceDiagram"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    participant M as Merchant"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    participant SA as Shopify Admin"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    participant A as Your App"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    participant API as Shopify API"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    M->>SA: Click \"Install App\""}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    SA->>A: Redirect với approval URL"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    A->>API: Exchange authorization code cho access token"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    API->>A: Return access token"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    A->>SA: Redirect back với session"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    SA->>A: Load app với authenticated session"}]}]]}]}]}],"\n",["$","h3",null,{"id":"chi-tiết-từng-bước","children":"Chi tiết từng bước"}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"1. Merchant click \"Install App\""}]}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"https://{shop}.myshopify.com/admin/apps/your-app\n"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"2. Shopify redirect đến app với approval URL"}]}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"https://your-app.com/auth?shop={shop}&timestamp={timestamp}&hmac={signature}\n"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"3. App validate request và redirect đến OAuth screen"}]}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"https://{shop}.myshopify.com/admin/oauth/authorize?\n  client_id={api_key}\n  &scope={scopes}\n  &redirect_uri={your-app.com/auth/callback}\n  &state={nonce}\n  &response_type=code\n"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"4. Merchant approve scopes"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"5. Shopify redirect với authorization code"}]}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"https://your-app.com/auth/callback?\n  shop={shop}\n  &code={authorization_code}\n  &state={nonce}\n  &hmac={signature}\n"}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"6. App exchange code cho access token"}]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" response"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" fetch"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  `"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"https://"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"$${"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":".myshopify.com/admin/oauth/access_token"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"`"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  {"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    method"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"POST"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    body"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" JSON"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"stringify"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"      client_id"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" apiKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"      client_secret"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" apiSecret"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"      code"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" authorizationCode"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"    })"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" access_token"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" response"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"7. App lưu session và redirect merchant đến app UI"}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"implementation-với-shopify-app-remix","children":"Implementation với Shopify App Remix"}],"\n",["$","h3",null,{"id":"shopifyserverts-configuration","children":"shopify.server.ts Configuration"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-remix/adapters/node"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  ApiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  AppDistribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  shopifyApp"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-remix/server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-redis"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"PrismaSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-prisma"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" shopifyApp"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_KEY"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiSecretKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_SECRET"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" ApiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"January25"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Scopes cần thiết"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  scopes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"    // Chỉ request scopes bạn cần"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    default"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ["}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_products"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"read_themes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_themes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"],"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // App URL"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  appUrl"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_APP_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Authentication path"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  authPathPrefix"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"/auth"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Session storage"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    url"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"REDIS_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    prefix"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"shopify_app_sessions"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Distribution (App Store hay Custom)"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  distribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" AppDistribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"AppStore"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Hooks"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  hooks"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"    // Sau khi merchant install app"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#82AAFF"},"children":"    afterAuth"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" =>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"      const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"      // Setup database records"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      await"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" setupStore"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" admin"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"      // Sync initial data"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      await"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" syncShopData"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" admin"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"      console"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"log"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"`"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"App installed for "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"$${"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}`"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"    }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Future features"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  future"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    unstable_newEmbeddedAuthStrategy"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" true"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    removeRest"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" true"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"})"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" default"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" unauthenticated"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"unauthenticated"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","h3",null,{"id":"session-storage-options","children":"Session Storage Options"}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"1. Redis (Recommended cho production)"}]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-redis"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  url"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"REDIS_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  prefix"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"shopify_app_sessions"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Optional: Custom Redis instance"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // redis: redisClient"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"})"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"2. MongoDB/Prisma"}]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"PrismaSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-prisma"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" PrismaSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"prisma"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"3. Memory (Chỉ cho development)"}]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"MemorySessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-memory"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" MemorySessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"scopes---quyền-truy-cập-app","children":"Scopes - Quyền truy cập App"}],"\n",["$","h3",null,{"id":"scopes-phổ-biến","children":"Scopes phổ biến"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Scope"}],["$","th",null,{"children":"Mô tả"}],["$","th",null,{"children":"Use case"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_products"}]}],["$","td",null,{"children":"Đọc/viết products"}],["$","td",null,{"children":"Product management apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"read_products"}]}],["$","td",null,{"children":"Đọc products"}],["$","td",null,{"children":"Analytics apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_orders"}]}],["$","td",null,{"children":"Đọc/viết orders"}],["$","td",null,{"children":"Order management"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"read_orders"}]}],["$","td",null,{"children":"Đọc orders"}],["$","td",null,{"children":"Reporting apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_customers"}]}],["$","td",null,{"children":"Đọc/viết customers"}],["$","td",null,{"children":"CRM apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_inventory"}]}],["$","td",null,{"children":"Quản lý inventory"}],["$","td",null,{"children":"Inventory apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"read_themes"}]}],["$","td",null,{"children":"Đọc theme files"}],["$","td",null,{"children":"Theme apps"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_themes"}]}],["$","td",null,{"children":"Ghi theme files"}],["$","td",null,{"children":"Apps inject code"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":["$","code",null,{"children":"write_script_tags"}]}],["$","td",null,{"children":"Thêm script tags"}],["$","td",null,{"children":"Apps inject JS"}]]}]]}]]}],"\n",["$","h3",null,{"id":"best-practices","children":"Best Practices"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// ❌ BAD: Request quá nhiều scopes"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"scopes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_products,write_orders,write_customers,write_inventory,write_script_tags"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// ✅ GOOD: Chỉ request cần thiết"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"scopes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  default"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":": "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"["}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_products"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_themes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"],"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"  admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"write_orders"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Chỉ cho admin users"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"sử-dụng-authentication-trong-routes","children":"Sử dụng Authentication trong Routes"}],"\n",["$","h3",null,{"id":"protected-routes-admin-ui","children":"Protected Routes (Admin UI)"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"tsx","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"tsx","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// app/routes/app._index.tsx"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"json"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" type"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" LoaderFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@remix-run/node"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"useLoaderData"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@remix-run/react"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"authenticate"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"../shopify.server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"Card"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" Page"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/polaris"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" loader"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" request"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }:"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" LoaderFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" =>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Authenticate và get session"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"admin"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"request"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Session object chứa:"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // - session.shop: Shop domain"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // - session.accessToken: API access token"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // - session.scope: Granted scopes"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Fetch data từ Shopify Admin API"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" response"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"graphql"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"`"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"    query {"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"      shop {"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"        name"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"        email"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"        primaryDomain { url }"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"      }"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#C3E88D"},"children":"    }"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  `"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" data"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" response"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  return"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"    shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    shopData"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" data"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"shop"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" default"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" function"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" Index"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shopData"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" useLoaderData"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"<typeof"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" loader"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  return"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    <"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"Page"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" title"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"Dashboard"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      <"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"Card"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"        <"}],["$","span",null,{"style":{"color":"#FF757F"},"children":"p"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"Welcome to "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"shopData"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"name"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}</"}],["$","span",null,{"style":{"color":"#FF757F"},"children":"p"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"        <"}],["$","span",null,{"style":{"color":"#FF757F"},"children":"p"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"Email: "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"shopData"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"email"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}</"}],["$","span",null,{"style":{"color":"#FF757F"},"children":"p"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      </"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"Card"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    </"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"Page"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  )"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"public-api-routes","children":"Public API Routes"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"tsx","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"tsx","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// app/routes/api.public.tsx"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"json"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" type"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" LoaderFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@remix-run/node"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"unauthenticated"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"../shopify.server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" loader"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" request"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }:"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" LoaderFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" =>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Không cần authentication"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // Dùng cho webhooks, public endpoints"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  return"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({ "}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":"message"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"Public endpoint"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"webhook-authentication","children":"Webhook Authentication"}],"\n",["$","p",null,{"children":"Webhooks cần HMAC verification để đảm bảo request đến từ Shopify."}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"tsx","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"tsx","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// app/routes/webhooks.app.uninstalled.tsx"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"json"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" type"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" ActionFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@remix-run/node"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"authenticate"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"../shopify.server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" action"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" request"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }:"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" ActionFunctionArgs"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" =>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // authenticate.webhook tự động verify HMAC"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" topic"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"webhook"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"request"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"topic"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ==="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"APP_UNINSTALLED"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") {"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"    // Session = null cho uninstall webhook"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"    // Dùng shop domain để cleanup"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    await"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" cleanupShopData"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    return"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({ "}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":"success"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" true"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  return"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" json"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({ "}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":"success"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" false"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"security-best-practices","children":"Security Best Practices"}],"\n",["$","h3",null,{"id":"1-environment-variables","children":"1. Environment Variables"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"bash","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"bash","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# .env"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"SHOPIFY_API_KEY"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"="}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"xxx"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"SHOPIFY_API_SECRET"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"="}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"xxx"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"SHOPIFY_APP_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"="}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"https://your-app.com"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"REDIS_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"="}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"redis://localhost:6379"}]]}]]}]}]}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// shopify.server.ts"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" shopifyApp"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_KEY"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"!,"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiSecretKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_SECRET"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"!,"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"  // ..."}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"})"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","h3",null,{"id":"2-https-cho-production","children":"2. HTTPS cho Production"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// Force HTTPS trong production"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#FFC777"},"children":"process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"NODE_ENV"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ==="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"production"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"  app"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"use"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"(("}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":"req"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" res"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" next"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") "}],["$","span",null,{"style":{"color":"#C099FF"},"children":"=>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#FFC777"},"children":"req"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"header"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"x-forwarded-proto"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"!=="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"https"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"      res"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"redirect"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"`"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"https://"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"$${"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"req"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"header"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"host"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}${"}],["$","span",null,{"style":{"color":"#FFC777"},"children":"req"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"url"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}`"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"    } "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"else"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#65BCFF"},"children":"      next"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"    }"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  })"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"3-session-validation","children":"3. Session Validation"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// Middleware để validate session"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" function"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" requireShop"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FCA7EA"},"children":"  request"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" Request"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" Promise"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"<"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"{"}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" string"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" AdminApiContext"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":">"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" {"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"admin"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"request"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"!"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"session"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    throw"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" redirect"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"/auth/login"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  return"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#4FD6BE"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" admin"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}]}]]}]}]}],"\n",["$","h3",null,{"id":"4-rate-limiting","children":"4. Rate Limiting"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// Rate limit API calls"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"redis"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"../redis.server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"async"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" function"}],["$","span",null,{"style":{"color":"#82AAFF"},"children":" checkRateLimit"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" string"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" key"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" `"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"ratelimit:"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"$${"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}`"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"  const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" count"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" redis"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"incr"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"key"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"count"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ==="}],["$","span",null,{"style":{"color":"#FF966C"},"children":" 1"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" redis"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"expire"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"key"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FF966C"},"children":" 60"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}],["$","span",null,{"style":{"color":"#858AA6"},"children":" // 1 minute window"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"  if"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"count"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" >"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" 100"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":") {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"    throw"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" Error"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"Rate limit exceeded"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"real-world-example","children":"Real-world Example"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// shopify.server.ts từ sticky-add-to-cart"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-remix/adapters/node"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  ApiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  AppDistribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C8D3F5"},"children":"  shopifyApp"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"}"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-remix/server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"@shopify/shopify-app-session-storage-redis"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" { "}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"connectToMongoDB"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"./mongoose.server"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" *"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" as"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" configRepository "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"./repositories/config.repository"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"import"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" *"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" as"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" storeRepository "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"from"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"./repositories/store.repository"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#65BCFF"},"children":"connectToMongoDB"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"()"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" shopifyApp"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"({"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_KEY"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiSecretKey"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_API_SECRET"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  apiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" ApiVersion"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"January25"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  scopes"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SCOPES"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"split"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":","}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  appUrl"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"SHOPIFY_APP_URL"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  authPathPrefix"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" \""}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"/auth"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"\""}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" new"}],["$","span",null,{"style":{"color":"#65BCFF"},"children":" RedisSessionStorage"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#FFC777"},"children":"process"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"env"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#FF98A4"},"children":"REDIS_URL"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  distribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" AppDistribution"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"AppStore"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  hooks"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#82AAFF"},"children":"    afterAuth"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" async"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" ("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"{"}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" admin"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}],["$","span",null,{"style":{"color":"#FCA7EA"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" }"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" =>"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#C099FF"},"children":"      const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" session"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"      // Create store record nếu chưa có"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" storeRepository"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"findOrCreate"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"      // Create config record"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"      await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" configRepository"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"findOrCreate"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"      console"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"log"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"`"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":"Setup complete for "}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"$${"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"shop"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"}`"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"    }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"  future"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":" {"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    unstable_newEmbeddedAuthStrategy"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" true"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#4FD6BE"},"children":"    removeRest"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":":"}],["$","span",null,{"style":{"color":"#FF966C"},"children":" true"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"  }"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":","}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#B4C2F0"},"children":"})"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" default"}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"export"}],["$","span",null,{"style":{"color":"#C099FF"},"children":" const"}],["$","span",null,{"style":{"color":"#FF98A4"},"children":" authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":" ="}],["$","span",null,{"style":{"color":"#FFC777"},"children":" shopify"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#A9B8E8"},"children":"authenticate"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"testing-authentication","children":"Testing Authentication"}],"\n",["$","h3",null,{"id":"test-với-development-store","children":"Test với Development Store"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"bash","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"bash","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# Start dev server"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#FFC777"},"children":"shopify"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":" app"}],["$","span",null,{"style":{"color":"#C3E88D"},"children":" dev"}]]}],"\n",["$","span",null,{"data-line":"","children":" "}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# CLI sẽ:"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# 1. Start tunnel"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# 2. Update app URL"}]}],"\n",["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"# 3. Prompt for installation"}]}]]}]}]}],"\n",["$","h3",null,{"id":"test-session-expiry","children":"Test Session Expiry"}],"\n",["$","figure",null,{"data-rehype-pretty-code-figure":"","children":["$","pre",null,{"style":{"backgroundColor":"#1F2028","color":"#c8d3f5"},"tabIndex":"0","data-language":"typescript","data-theme":"moonlight-ii","children":["$","code",null,{"data-language":"typescript","data-theme":"moonlight-ii","style":{"display":"grid"},"children":[["$","span",null,{"data-line":"","children":["$","span",null,{"style":{"color":"#858AA6"},"children":"// Test session expiry manually"}]}],"\n",["$","span",null,{"data-line":"","children":[["$","span",null,{"style":{"color":"#86E1FC"},"children":"await"}],["$","span",null,{"style":{"color":"#FFC777"},"children":" sessionStorage"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":"."}],["$","span",null,{"style":{"color":"#65BCFF"},"children":"deleteSession"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":"("}],["$","span",null,{"style":{"color":"#C8D3F5"},"children":"sessionId"}],["$","span",null,{"style":{"color":"#B4C2F0"},"children":")"}],["$","span",null,{"style":{"color":"#86E1FC"},"children":";"}]]}]]}]}]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"common-issues","children":"Common Issues"}],"\n",["$","h3",null,{"id":"issue-invalid-hmac-signature","children":"Issue: \"Invalid HMAC signature\""}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"Solution:"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Verify API secret key"}],"\n",["$","li",null,{"children":"Check request parameters"}],"\n",["$","li",null,{"children":"Ensure timestamps are valid (5 minute window)"}],"\n"]}],"\n",["$","h3",null,{"id":"issue-session-not-found","children":"Issue: \"Session not found\""}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"Solution:"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Check Redis connection"}],"\n",["$","li",null,{"children":"Verify session storage configuration"}],"\n",["$","li",null,{"children":"Check session TTL settings"}],"\n"]}],"\n",["$","h3",null,{"id":"issue-access-denied","children":"Issue: \"Access denied\""}],"\n",["$","p",null,{"children":["$","strong",null,{"children":"Solution:"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Verify scopes are requested"}],"\n",["$","li",null,{"children":"Check merchant approved all required scopes"}],"\n",["$","li",null,{"children":"Review API permissions in Partner Dashboard"}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"key-takeaways","children":"Key Takeaways"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"OAuth flow"}]," bảo vệ app và xác thực merchant"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Session storage"}]," (Redis/MongoDB) lưu authentication state"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Scopes"}]," định nghĩa quyền truy cập - chỉ request cần thiết"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"authenticate.admin()"}]," bảo vệ admin routes"]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"authenticate.webhook()"}]," verify webhook HMAC signatures"]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"tài-nguyên-tham-khảo","children":"Tài nguyên tham khảo"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["$","a",null,{"href":"https://shopify.dev/docs/apps/auth","children":"Shopify OAuth Documentation"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://shopify.dev/docs/apps/auth/session-tokens","children":"Session Tokens"}]}],"\n",["$","li",null,{"children":["$","a",null,{"href":"https://shopify.dev/docs/api/alignment/access-scopes","children":"API Scopes"}]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"next-steps","children":"Next Steps"}],"\n",["$","p",null,{"children":["Trong ",["$","strong",null,{"children":"Phần 5"}],", bạn sẽ học:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Remix framework chi tiết"}],"\n",["$","li",null,{"children":"Shopify Polaris components"}],"\n",["$","li",null,{"children":"Xây dựng Admin UI"}],"\n",["$","li",null,{"children":"Loaders và Actions"}],"\n"]}],"\n",["$","p",null,{"children":["$","a",null,{"href":"/blog/xay-dung-admin-ui-remix-polaris","children":"Đọc Phần 5: Xây dựng Admin UI với Remix và Polaris →"}]}],"\n",["$","p",null,{"children":["$","a",null,{"href":"/blog/tao-project-shopify-app-dau-tien","children":"← Quay lại Phần 3: Tạo project đầu tiên"}]}]]],null],null]},["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","shopify-app-authentication","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","div",null,{"className":"","children":[["$","$L4",null,{"href":"/","className":"text-blue-500 hover:text-blue-700","children":" Back to home"}],["$","article",null,{"className":"mt-4","children":["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]}]]}],null],null]},[["$","html",null,{"lang":"en","children":[["$","head",null,{"children":["$","link",null,{"rel":"stylesheet","href":"https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css"}]}],["$","body",null,{"className":"antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16","children":["$","$L2",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L3",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}]]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/87b0bca2e9e24b11.css","precedence":"next","crossOrigin":"$undefined"}]],"$L5"]]]]
5:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Authentication & Authorization trong Shopify App - Hướng dẫn chi tiết"}],["$","meta","3",{"name":"description","content":"Tìm hiểu về OAuth flow, session management, access tokens và securing Shopify App của bạn."}]]
1:null
