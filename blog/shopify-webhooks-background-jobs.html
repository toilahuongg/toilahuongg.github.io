<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/87b0bca2e9e24b11.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-82b2ba201d35e58a.js"/><script src="/_next/static/chunks/fd9d1056-2821b0f0cabcd8bd.js" async=""></script><script src="/_next/static/chunks/23-2309b8fd26fbddcb.js" async=""></script><script src="/_next/static/chunks/main-app-abc6aca9473c726e.js" async=""></script><script src="/_next/static/chunks/231-bea070b1ecddfbbc.js" async=""></script><script src="/_next/static/chunks/app/blog/layout-a90c7b1536f7eb16.js" async=""></script><title>Shopify Webhooks và Background Jobs - Hướng dẫn chi tiết</title><meta name="description" content="Hướng dẫn xử lý webhooks, background jobs và cron tasks trong Shopify App."/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16"><div class=""><a class="text-blue-500 hover:text-blue-700" href="/"> Back to home</a><article class="mt-4"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#giới-thiệu">Giới thiệu</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#webhook-fundamentals">Webhook Fundamentals</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#what-are-webhooks">What are Webhooks?</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#common-webhooks">Common Webhooks</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#register-webhooks">Register Webhooks</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#using-cli">Using CLI</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#manual-registration">Manual Registration</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#using-admin-api">Using Admin API</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#webhook-handlers">Webhook Handlers</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#basic-pattern">Basic Pattern</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#order-created-handler">Order Created Handler</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#hmac-verification">HMAC Verification</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#built-in-verification">Built-in Verification</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#manual-verification">Manual Verification</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#background-jobs">Background Jobs</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#for-long-running-tasks">For Long-running Tasks</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#usage-in-webhook">Usage in Webhook</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#cron-jobs">Cron Jobs</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#scheduled-tasks">Scheduled Tasks</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#with-shopify-cli">With Shopify CLI</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#error-handling--retries">Error Handling &amp; Retries</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#retry-logic">Retry Logic</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#retry-schedule">Retry Schedule</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#testing-webhooks">Testing Webhooks</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#local-testing">Local Testing</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#with-shopify-cli-1">With Shopify CLI</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#manual-testing">Manual Testing</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#monitoring">Monitoring</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#log-webhook-deliveries">Log Webhook Deliveries</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#dashboard">Dashboard</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#best-practices">Best Practices</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-quick-response">1. Quick Response</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-idempotency">2. Idempotency</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#3-graceful-degradation">3. Graceful Degradation</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#key-takeaways">Key Takeaways</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#next-steps">Next Steps</a></li></ol></nav>
<h1 id="shopify-webhooks-và-background-jobs">Shopify Webhooks và Background Jobs</h1>
<h2 id="giới-thiệu">Giới thiệu</h2>
<p>Webhooks cho phép app nhận real-time notifications về events trong store. Bài viết này sẽ hướng dẫn xử lý webhooks và background jobs hiệu quả.</p>
<hr/>
<h2 id="webhook-fundamentals">Webhook Fundamentals</h2>
<h3 id="what-are-webhooks">What are Webhooks?</h3>
<p><strong>Webhooks</strong> là HTTP POST requests Shopify gửi đến app khi có events xảy ra.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="mermaid" data-theme="moonlight-ii"><code data-language="mermaid" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#C8D3F5">sequenceDiagram</span></span>
<span data-line=""><span style="color:#C8D3F5">    participant S as Store</span></span>
<span data-line=""><span style="color:#C8D3F5">    participant SH as Shopify</span></span>
<span data-line=""><span style="color:#C8D3F5">    participant W as Your Webhook Endpoint</span></span>
<span data-line=""><span style="color:#C8D3F5">    participant DB as Your Database</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C8D3F5">    S-&gt;&gt;SH: Event occurs (order created)</span></span>
<span data-line=""><span style="color:#C8D3F5">    SH-&gt;&gt;W: POST /webhooks/orders/create</span></span>
<span data-line=""><span style="color:#C8D3F5">    W-&gt;&gt;DB: Process event</span></span>
<span data-line=""><span style="color:#C8D3F5">    W-&gt;&gt;SH: Return 200 OK</span></span></code></pre></figure>
<h3 id="common-webhooks">Common Webhooks</h3>
<table><thead><tr><th>Topic</th><th>Description</th><th>Use case</th></tr></thead><tbody><tr><td><code>app/uninstalled</code></td><td>App uninstalled</td><td>Cleanup data</td></tr><tr><td><code>orders/create</code></td><td>New order</td><td>Sync to external system</td></tr><tr><td><code>orders/updated</code></td><td>Order updated</td><td>Update tracking</td></tr><tr><td><code>products/create</code></td><td>New product</td><td>Index in search</td></tr><tr><td><code>products/update</code></td><td>Product updated</td><td>Sync inventory</td></tr><tr><td><code>customers/create</code></td><td>New customer</td><td>Add to CRM</td></tr></tbody></table>
<hr/>
<h2 id="register-webhooks">Register Webhooks</h2>
<h3 id="using-cli">Using CLI</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#FFC777">shopify</span><span style="color:#C3E88D"> app</span><span style="color:#C3E88D"> generate</span><span style="color:#C3E88D"> webhook</span></span></code></pre></figure>
<p>CLI sẽ prompt:</p>
<pre><code>? Which webhook topics would you like to subscribe to?
❯ app/uninstalled
  orders/create
  orders/updated
  products/create
</code></pre>
<h3 id="manual-registration">Manual Registration</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/shopify.server.ts</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> shopify</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> shopifyApp</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#858AA6">  // ... other config</span></span>
<span data-line=""><span style="color:#4FD6BE">  webhooks</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    APP_UNINSTALLED</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">      deliveryMethod</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">http</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      callbackUrl</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">/webhooks/app/uninstalled</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="using-admin-api">Using Admin API</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> response</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> admin</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">graphql</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span></span>
<span data-line=""><span style="color:#C3E88D">  mutation webhookSubscriptionCreate {</span></span>
<span data-line=""><span style="color:#C3E88D">    webhookSubscriptionCreate(</span></span>
<span data-line=""><span style="color:#C3E88D">      topic: APP_UNINSTALLED</span></span>
<span data-line=""><span style="color:#C3E88D">      webhookSubscription: {</span></span>
<span data-line=""><span style="color:#C3E88D">        callbackUrl: &quot;https://your-app.com/webhooks/app/uninstalled&quot;</span></span>
<span data-line=""><span style="color:#C3E88D">        format: JSON</span></span>
<span data-line=""><span style="color:#C3E88D">      }</span></span>
<span data-line=""><span style="color:#C3E88D">    ) {</span></span>
<span data-line=""><span style="color:#C3E88D">      webhookSubscription {</span></span>
<span data-line=""><span style="color:#C3E88D">        id</span></span>
<span data-line=""><span style="color:#C3E88D">      }</span></span>
<span data-line=""><span style="color:#C3E88D">      userErrors {</span></span>
<span data-line=""><span style="color:#C3E88D">        field</span></span>
<span data-line=""><span style="color:#C3E88D">        message</span></span>
<span data-line=""><span style="color:#C3E88D">      }</span></span>
<span data-line=""><span style="color:#C3E88D">    }</span></span>
<span data-line=""><span style="color:#C3E88D">  }</span></span>
<span data-line=""><span style="color:#86E1FC">`</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="webhook-handlers">Webhook Handlers</h2>
<h3 id="basic-pattern">Basic Pattern</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/webhooks.app.uninstalled.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">json</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> type</span><span style="color:#C8D3F5"> ActionFunctionArgs</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">authenticate</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../shopify.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#FF98A4"> *</span><span style="color:#86E1FC"> as</span><span style="color:#C8D3F5"> configRepository </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../repositories/config.repository</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#FF98A4"> *</span><span style="color:#86E1FC"> as</span><span style="color:#C8D3F5"> storeRepository </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../repositories/store.repository</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // authenticate.webhook tự động verify HMAC</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> admin</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">topic</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">APP_UNINSTALLED</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#858AA6">    // Cleanup app data</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#FFC777"> configRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">deleteByShop</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#FFC777"> storeRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">markUninstalled</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">    console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">log</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span><span style="color:#C3E88D">App uninstalled for </span><span style="color:#86E1FC">${</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">}`</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">status</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 400</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="order-created-handler">Order Created Handler</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/webhooks.orders.create.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> admin</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">topic</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">ORDERS_CREATE</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> body</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Extract order data</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> order</span><span style="color:#86E1FC"> =</span><span style="color:#C8D3F5"> body</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> orderId</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> order</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">id</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> orderNumber</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> order</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">order_number</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> customerEmail</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> order</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">customer</span><span style="color:#86E1FC">?.</span><span style="color:#A9B8E8">email</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> totalPrice</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> order</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">total_price</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Sync đến external system</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> syncOrderToCRM</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#C8D3F5">      shop</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      orderId</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      orderNumber</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      customerEmail</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      totalPrice</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Send notification</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> sendNewOrderNotification</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#C8D3F5">      shop</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      orderNumber</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      totalPrice</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">status</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 400</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="hmac-verification">HMAC Verification</h2>
<p>Shopify signs webhook requests với HMAC để verify authenticity.</p>
<h3 id="built-in-verification">Built-in Verification</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// authenticate.webhook() tự động verify HMAC</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="manual-verification">Manual Verification</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">import</span><span style="color:#C8D3F5"> crypto </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">crypto</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">function</span><span style="color:#82AAFF"> verifyWebhookRequest</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FCA7EA">  body</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  hmacHeader</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  webhookSecret</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> calculatedHmac</span><span style="color:#86E1FC"> =</span><span style="color:#C8D3F5"> crypto</span></span>
<span data-line=""><span style="color:#86E1FC">    .</span><span style="color:#65BCFF">createHmac</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">sha256</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> webhookSecret</span><span style="color:#B4C2F0">)</span></span>
<span data-line=""><span style="color:#86E1FC">    .</span><span style="color:#65BCFF">update</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">body</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">utf8</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span></span>
<span data-line=""><span style="color:#86E1FC">    .</span><span style="color:#65BCFF">digest</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">base64</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Compare timing-safe</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#FFC777"> crypto</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">timingSafeEqual</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FFC777">    Buffer</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">from</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">calculatedHmac</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">    Buffer</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">from</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">hmacHeader</span><span style="color:#B4C2F0">)</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Usage</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> rawBody</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">text</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> hmacHeader</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">headers</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">get</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">X-Shopify-Hmac-Sha256</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#65BCFF">verifyWebhookRequest</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">rawBody</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> hmacHeader</span><span style="color:#86E1FC">,</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">WEBHOOK_SECRET</span><span style="color:#B4C2F0">)) {</span></span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">error</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Invalid HMAC</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">status</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 401</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> data</span><span style="color:#86E1FC"> =</span><span style="color:#FF98A4"> JSON</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">parse</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">rawBody</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#858AA6">  // Process webhook...</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="background-jobs">Background Jobs</h2>
<h3 id="for-long-running-tasks">For Long-running Tasks</h3>
<p>Webhooks must respond quickly (&lt;5 seconds). Use background jobs cho heavy processing.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/services/job-queue.service.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Queue</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> Worker</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bullmq</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">redis</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../redis.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Create queue</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> jobQueue</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Queue</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">webhook-jobs</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  connection</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> redis</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Add job to queue</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> addOrderSyncJob</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">orderId</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#FFC777"> jobQueue</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">add</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#86E1FC">    &quot;</span><span style="color:#C3E88D">sync-order</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">orderId</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    {</span></span>
<span data-line=""><span style="color:#4FD6BE">      attempts</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 3</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      backoff</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">        type</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">exponential</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        delay</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1000</span></span>
<span data-line=""><span style="color:#B4C2F0">      }</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Process jobs</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> worker</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Worker</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#86E1FC">  &quot;</span><span style="color:#C3E88D">webhook-jobs</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C099FF">  async</span><span style="color:#B4C2F0"> (</span><span style="color:#FCA7EA">job</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> orderId</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> job</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">data</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Do heavy processing</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> syncOrderToCRM</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">orderId</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  {</span><span style="color:#4FD6BE"> connection</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> redis</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="usage-in-webhook">Usage in Webhook</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">topic</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">ORDERS_CREATE</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> body</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Queue job instead of processing immediately</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> addOrderSyncJob</span><span style="color:#B4C2F0">(</span><span style="color:#FFC777">body</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">id</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Respond immediately</span></span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="cron-jobs">Cron Jobs</h2>
<h3 id="scheduled-tasks">Scheduled Tasks</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/api.cron.analytics.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">json</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> type</span><span style="color:#C8D3F5"> ActionFunctionArgs</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // Verify cron secret</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> authHeader</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">headers</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">get</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">authorization</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">authHeader</span><span style="color:#86E1FC"> !==</span><span style="color:#86E1FC"> `</span><span style="color:#C3E88D">Bearer </span><span style="color:#86E1FC">${</span><span style="color:#FFC777">process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">CRON_SECRET</span><span style="color:#86E1FC">}`</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">error</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Unauthorized</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">status</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 401</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Run daily analytics aggregation</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> shops</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> storeRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">getAllActive</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> results</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> [];</span></span>
<span data-line=""><span style="color:#86E1FC">  for</span><span style="color:#B4C2F0"> (</span><span style="color:#C099FF">const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> of</span><span style="color:#C8D3F5"> shops</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> dailyStats</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#65BCFF"> aggregateDailyStats</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">    results</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">push</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">shop</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> shop</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> stats</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> dailyStats</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">    success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    processed</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> results</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">length</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">    results</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Setup cron job (external)</span></span>
<span data-line=""><span style="color:#858AA6">// 0 2 * * * curl -X POST https://your-app.com/api/cron/analytics \</span></span>
<span data-line=""><span style="color:#858AA6">//   -H &quot;Authorization: Bearer YOUR_CRON_SECRET&quot;</span></span></code></pre></figure>
<h3 id="with-shopify-cli">With Shopify CLI</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># Create cron job</span></span>
<span data-line=""><span style="color:#FFC777">shopify</span><span style="color:#C3E88D"> app</span><span style="color:#C3E88D"> generate</span><span style="color:#C3E88D"> cron</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6"># Cron job route created at app/routes/api.cron.tsx</span></span></code></pre></figure>
<hr/>
<h2 id="error-handling--retries">Error Handling &amp; Retries</h2>
<h3 id="retry-logic">Retry Logic</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">topic</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">ORDERS_CREATE</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    try</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">      await</span><span style="color:#65BCFF"> processOrder</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">())</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">      return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    } </span><span style="color:#86E1FC">catch</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#858AA6">      // Log error</span></span>
<span data-line=""><span style="color:#FFC777">      console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">error</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Webhook processing failed:</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> error</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">      // Return 5xx để Shopify retry</span></span>
<span data-line=""><span style="color:#858AA6">      // Shopify sẽ retry với exponential backoff</span></span>
<span data-line=""><span style="color:#86E1FC">      return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">        { </span><span style="color:#4FD6BE">error</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Processing failed</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">        { </span><span style="color:#4FD6BE">status</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 503</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">      )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="retry-schedule">Retry Schedule</h3>
<table><thead><tr><th>Response</th><th>Action</th></tr></thead><tbody><tr><td>200-299</td><td>Success - don&#x27;t retry</td></tr><tr><td>400-499</td><td>Client error - don&#x27;t retry</td></tr><tr><td>500-599</td><td>Server error - retry with backoff</td></tr></tbody></table>
<p><strong>Retry intervals:</strong></p>
<ul>
<li>Attempt 1: Immediately</li>
<li>Attempt 2: ~2 seconds later</li>
<li>Attempt 3: ~10 seconds later</li>
<li>Attempt 4: ~1 hour later</li>
<li>Attempt 5: ~12 hours later</li>
<li>Attempt 6+: ~24 hours later</li>
</ul>
<hr/>
<h2 id="testing-webhooks">Testing Webhooks</h2>
<h3 id="local-testing">Local Testing</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># Start dev server</span></span>
<span data-line=""><span style="color:#FFC777">shopify</span><span style="color:#C3E88D"> app</span><span style="color:#C3E88D"> dev</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6"># CLI provides ngrok URL</span></span>
<span data-line=""><span style="color:#858AA6"># Use it in Shopify webhook configuration</span></span></code></pre></figure>
<h3 id="with-shopify-cli-1">With Shopify CLI</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># Trigger test webhook</span></span>
<span data-line=""><span style="color:#FFC777">shopify</span><span style="color:#C3E88D"> webhook</span><span style="color:#C3E88D"> trigger</span></span></code></pre></figure>
<h3 id="manual-testing">Manual Testing</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># Send test webhook</span></span>
<span data-line=""><span style="color:#FFC777">curl</span><span style="color:#C3E88D"> -X</span><span style="color:#C3E88D"> POST</span><span style="color:#C3E88D"> https://your-app.com/webhooks/orders/create</span><span style="color:#86E1FC"> \</span></span>
<span data-line=""><span style="color:#C3E88D">  -H</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Content-Type: application/json</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> \</span></span>
<span data-line=""><span style="color:#C3E88D">  -H</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">X-Shopify-Topic: orders/create</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> \</span></span>
<span data-line=""><span style="color:#C3E88D">  -H</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">X-Shopify-Hmac-Sha256: CALCULATED_HMAC</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> \</span></span>
<span data-line=""><span style="color:#C3E88D">  -d</span><span style="color:#86E1FC"> &#x27;</span><span style="color:#C3E88D">{&quot;id&quot;: &quot;gid://shopify/Order/123&quot;, ...}</span><span style="color:#86E1FC">&#x27;</span></span></code></pre></figure>
<hr/>
<h2 id="monitoring">Monitoring</h2>
<h3 id="log-webhook-deliveries">Log Webhook Deliveries</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> startTime</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">now</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  try</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> processWebhook</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">())</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> duration</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">now</span><span style="color:#B4C2F0">() </span><span style="color:#86E1FC">-</span><span style="color:#C8D3F5"> startTime</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Log success</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> logWebhookEvent</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#C8D3F5">      shop</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      topic</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      status</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">success</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      duration</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  } </span><span style="color:#86E1FC">catch</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> duration</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">now</span><span style="color:#B4C2F0">() </span><span style="color:#86E1FC">-</span><span style="color:#C8D3F5"> startTime</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">    // Log error</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> logWebhookEvent</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#C8D3F5">      shop</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      topic</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      status</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">error</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">      duration</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      error</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> error</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">message</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    throw</span><span style="color:#C8D3F5"> error</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="dashboard">Dashboard</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Admin UI để xem webhook status</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> loader</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> LoaderFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">admin</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> webhookStats</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#65BCFF"> getWebhookStats</span><span style="color:#B4C2F0">(</span><span style="color:#FFC777">session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">webhookStats</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#86E1FC"> default</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> WebhookDashboard</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> stats</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> useLoaderData</span><span style="color:#86E1FC">&lt;typeof</span><span style="color:#C8D3F5"> loader</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#B4C2F0"> (</span></span>
<span data-line=""><span style="color:#86E1FC">    &lt;</span><span style="color:#FFC777">Page</span><span style="color:#C099FF"> title</span><span style="color:#86E1FC">=</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Webhook Status</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">      &lt;</span><span style="color:#FFC777">Card</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">        &lt;</span><span style="color:#FFC777">BlockStack</span><span style="color:#C099FF"> gap</span><span style="color:#86E1FC">=</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">400</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">          &lt;</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Total Webhooks: </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">stats</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">total</span><span style="color:#86E1FC">}&lt;/</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">          &lt;</span><span style="color:#FFC777">Text</span><span style="color:#C099FF"> tone</span><span style="color:#86E1FC">=</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">success</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Success: </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">stats</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">success</span><span style="color:#86E1FC">}&lt;/</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">          &lt;</span><span style="color:#FFC777">Text</span><span style="color:#C099FF"> tone</span><span style="color:#86E1FC">=</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">critical</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Failed: </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">stats</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">failed</span><span style="color:#86E1FC">}&lt;/</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">          &lt;</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Average Duration: </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">stats</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">avgDuration</span><span style="color:#86E1FC">}</span><span style="color:#B4C2F0">ms</span><span style="color:#86E1FC">&lt;/</span><span style="color:#FFC777">Text</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">        &lt;/</span><span style="color:#FFC777">BlockStack</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">      &lt;/</span><span style="color:#FFC777">Card</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">    &lt;/</span><span style="color:#FFC777">Page</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-quick-response">1. Quick Response</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// ❌ BAD - Long processing</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> data</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#65BCFF"> heavyProcessing</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">data</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span><span style="color:#858AA6"> // Takes 10 seconds</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// ✅ GOOD - Queue job</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> data</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#65BCFF"> queueJob</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">data</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span><span style="color:#858AA6"> // Returns immediately</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="2-idempotency">2. Idempotency</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Handle duplicate webhooks</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> processedWebhooks</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Set</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> action</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> body</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> webhookId</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> body</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">admin_graphql_api_id</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Check if already processed</span></span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#FFC777">processedWebhooks</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">has</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">webhookId</span><span style="color:#B4C2F0">)) {</span></span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> message</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Already processed</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#65BCFF"> processWebhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">body</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">  processedWebhooks</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">add</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">webhookId</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="3-graceful-degradation">3. Graceful Degradation</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">try</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#65BCFF"> criticalOperation</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">data</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC"> catch</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // Log nhưng không fail webhook</span></span>
<span data-line=""><span style="color:#FFC777">  console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">error</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Operation failed:</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> error</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">  await</span><span style="color:#65BCFF"> notifySupport</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">error</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Always return success</span></span>
<span data-line=""><span style="color:#86E1FC">return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="key-takeaways">Key Takeaways</h2>
<ol>
<li><strong>Webhooks</strong> - Real-time event notifications</li>
<li><strong>HMAC verification</strong> - Built-in with authenticate.webhook()</li>
<li><strong>Background jobs</strong> - Queue heavy processing</li>
<li><strong>Quick response</strong> - Respond &lt;5 seconds</li>
<li><strong>Retries</strong> - Return 5xx for automatic retry</li>
</ol>
<hr/>
<h2 id="next-steps">Next Steps</h2>
<p>Trong <strong>Phần 10</strong>, bạn sẽ học:</p>
<ul>
<li>Testing strategies</li>
<li>CI/CD setup</li>
<li>Deployment options</li>
<li>App Store submission</li>
</ul>
<p><a href="/blog/shopify-app-testing-deployment">Đọc Phần 10: Testing, Deployment &amp; Launch →</a></p>
<p><a href="/blog/shopify-theme-extensions">← Quay lại Phần 8: Theme Extensions</a></p></article></div><script src="/_next/static/chunks/webpack-82b2ba201d35e58a.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/87b0bca2e9e24b11.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n4:I[9275,[],\"\"]\n5:I[1343,[],\"\"]\n6:I[231,[\"231\",\"static/chunks/231-bea070b1ecddfbbc.js\",\"768\",\"static/chunks/app/blog/layout-a90c7b1536f7eb16.js\"],\"\"]\n8:I[6130,[],\"\"]\n9:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/87b0bca2e9e24b11.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"tzSBi7OSOzBYC6JMq0Fsk\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/shopify-webhooks-background-jobs\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-webhooks-background-jobs\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-webhooks-background-jobs\",{\"children\":[\"__PAGE__\",{},[[\"$L3\",[[\"$\",\"nav\",null,{\"className\":\"toc\",\"children\":[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-1\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#giới-thiệu\",\"children\":\"Giới thiệu\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#webhook-fundamentals\",\"children\":\"Webhook Fundamentals\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#what-are-webhooks\",\"children\":\"What are Webhooks?\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#common-webhooks\",\"children\":\"Common Webhooks\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#register-webhooks\",\"children\":\"Register Webhooks\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#using-cli\",\"children\":\"Using CLI\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#manual-registration\",\"children\":\"Manual Registration\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#using-admin-api\",\"children\":\"Using Admin API\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#webhook-handlers\",\"children\":\"Webhook Handlers\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#basic-pattern\",\"children\":\"Basic Pattern\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#order-created-handler\",\"children\":\"Order Created Handler\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#hmac-verification\",\"children\":\"HMAC Verification\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#built-in-verification\",\"children\":\"Built-in Verification\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#manual-verification\",\"children\":\"Manual Verification\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#background-jobs\",\"children\":\"Background Jobs\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#for-long-running-tasks\",\"children\":\"For Long-running Tasks\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#usage-in-webhook\",\"children\":\"Usage in Webhook\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#cron-jobs\",\"children\":\"Cron Jobs\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#scheduled-tasks\",\"children\":\"Scheduled Tasks\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#with-shopify-cli\",\"children\":\"With Shopify CLI\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#error-handling--retries\",\"children\":\"Error Handling \u0026 Retries\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#retry-logic\",\"children\":\"Retry Logic\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#retry-schedule\",\"children\":\"Retry Schedule\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#testing-webhooks\",\"children\":\"Testing Webhooks\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#local-testing\",\"children\":\"Local Testing\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#with-shopify-cli-1\",\"children\":\"With Shopify CLI\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#manual-testing\",\"children\":\"Manual Testing\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#monitoring\",\"children\":\"Monitoring\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#log-webhook-deliveries\",\"children\":\"Log Webhook Deliveries\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#dashboard\",\"children\":\"Dashboard\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#best-practices\",\"children\":\"Best Practices\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#1-quick-response\",\"children\":\"1. Quick Response\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#2-idempotency\",\"children\":\"2. Idempotency\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#3-graceful-degradation\",\"children\":\"3. Graceful Degradation\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#key-takeaways\",\"children\":\"Key Takeaways\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#next-steps\",\"children\":\"Next Steps\"}]}]]}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"shopify-webhooks-và-background-jobs\",\"children\":\"Shopify Webhooks và Background Jobs\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"giới-thiệu\",\"children\":\"Giới thiệu\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Webhooks cho phép app nhận real-time notifications về events trong store. Bài viết này sẽ hướng dẫn xử lý webhooks và background jobs hiệu quả.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"webhook-fundamentals\",\"children\":\"Webhook Fundamentals\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"what-are-webhooks\",\"children\":\"What are Webhooks?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Webhooks\"}],\" là HTTP POST requests Shopify gửi đến app khi có events xảy ra.\"]}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"mermaid\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"mermaid\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"sequenceDiagram\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    participant S as Store\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    participant SH as Shopify\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    participant W as Your Webhook Endpoint\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    participant DB as Your Database\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    S-\u003e\u003eSH: Event occurs (order created)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    SH-\u003e\u003eW: POST /webhooks/orders/create\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    W-\u003e\u003eDB: Process event\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    W-\u003e\u003eSH: Return 200 OK\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"common-webhooks\",\"children\":\"Common Webhooks\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Topic\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}],[\"$\",\"th\",null,{\"children\":\"Use case\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"app/uninstalled\"}]}],[\"$\",\"td\",null,{\"children\":\"App uninstalled\"}],[\"$\",\"td\",null,{\"children\":\"Cleanup data\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"orders/create\"}]}],[\"$\",\"td\",null,{\"children\":\"New order\"}],[\"$\",\"td\",null,{\"children\":\"Sync to external system\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"orders/updated\"}]}],[\"$\",\"td\",null,{\"children\":\"Order updated\"}],[\"$\",\"td\",null,{\"children\":\"Update tracking\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"products/create\"}]}],[\"$\",\"td\",null,{\"children\":\"New product\"}],[\"$\",\"td\",null,{\"children\":\"Index in search\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"products/update\"}]}],[\"$\",\"td\",null,{\"children\":\"Product updated\"}],[\"$\",\"td\",null,{\"children\":\"Sync inventory\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"customers/create\"}]}],[\"$\",\"td\",null,{\"children\":\"New customer\"}],[\"$\",\"td\",null,{\"children\":\"Add to CRM\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"register-webhooks\",\"children\":\"Register Webhooks\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"using-cli\",\"children\":\"Using CLI\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" app\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" generate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" webhook\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"CLI sẽ prompt:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"? Which webhook topics would you like to subscribe to?\\n❯ app/uninstalled\\n  orders/create\\n  orders/updated\\n  products/create\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"manual-registration\",\"children\":\"Manual Registration\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/shopify.server.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // ... other config\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  webhooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    APP_UNINSTALLED\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      deliveryMethod\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"http\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      callbackUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"/webhooks/app/uninstalled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"using-admin-api\",\"children\":\"Using Admin API\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"graphql\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  mutation webhookSubscriptionCreate {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"    webhookSubscriptionCreate(\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      topic: APP_UNINSTALLED\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      webhookSubscription: {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        callbackUrl: \\\"https://your-app.com/webhooks/app/uninstalled\\\"\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        format: JSON\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"    ) {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      webhookSubscription {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        id\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      userErrors {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        field\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        message\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"webhook-handlers\",\"children\":\"Webhook Handlers\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"basic-pattern\",\"children\":\"Basic Pattern\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/webhooks.app.uninstalled.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../shopify.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" *\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" configRepository \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../repositories/config.repository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" *\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" storeRepository \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../repositories/store.repository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // authenticate.webhook tự động verify HMAC\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"APP_UNINSTALLED\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Cleanup app data\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"deleteByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" storeRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"markUninstalled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"App uninstalled for \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 400\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"order-created-handler\",\"children\":\"Order Created Handler\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/webhooks.orders.create.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"ORDERS_CREATE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Extract order data\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" orderNumber\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"order_number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" customerEmail\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"customer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"email\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" totalPrice\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"total_price\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Sync đến external system\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" syncOrderToCRM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      orderNumber\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      customerEmail\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      totalPrice\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Send notification\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" sendNewOrderNotification\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      orderNumber\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      totalPrice\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 400\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"hmac-verification\",\"children\":\"HMAC Verification\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Shopify signs webhook requests với HMAC để verify authenticity.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"built-in-verification\",\"children\":\"Built-in Verification\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// authenticate.webhook() tự động verify HMAC\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"manual-verification\",\"children\":\"Manual Verification\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" crypto \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"crypto\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" verifyWebhookRequest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  hmacHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  webhookSecret\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" calculatedHmac\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" crypto\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"createHmac\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"sha256\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" webhookSecret\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"update\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"utf8\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    .\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"digest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"base64\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Compare timing-safe\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" crypto\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"timingSafeEqual\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    Buffer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"calculatedHmac\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    Buffer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"hmacHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Usage\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" rawBody\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" hmacHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"headers\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"X-Shopify-Hmac-Sha256\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"verifyWebhookRequest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"rawBody\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" hmacHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"WEBHOOK_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Invalid HMAC\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 401\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" JSON\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"parse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"rawBody\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Process webhook...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"background-jobs\",\"children\":\"Background Jobs\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"for-long-running-tasks\",\"children\":\"For Long-running Tasks\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Webhooks must respond quickly (\u003c5 seconds). Use background jobs cho heavy processing.\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/services/job-queue.service.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Queue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Worker\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bullmq\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../redis.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Create queue\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" jobQueue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Queue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"webhook-jobs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" redis\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Add job to queue\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" addOrderSyncJob\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" jobQueue\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"sync-order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      attempts\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 3\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      backoff\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"exponential\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        delay\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1000\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Process jobs\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" worker\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Worker\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"webhook-jobs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"job\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" job\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Do heavy processing\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" syncOrderToCRM\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"orderId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"usage-in-webhook\",\"children\":\"Usage in Webhook\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"ORDERS_CREATE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Queue job instead of processing immediately\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" addOrderSyncJob\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Respond immediately\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"cron-jobs\",\"children\":\"Cron Jobs\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"scheduled-tasks\",\"children\":\"Scheduled Tasks\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/api.cron.analytics.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Verify cron secret\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" authHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"headers\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"authorization\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"authHeader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" !==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" `\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Bearer \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"CRON_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Unauthorized\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 401\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Run daily analytics aggregation\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shops\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" storeRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"getAllActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" results\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [];\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  for\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" of\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shops\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" dailyStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" aggregateDailyStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    results\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"push\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" dailyStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    processed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" results\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"length\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    results\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Setup cron job (external)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// 0 2 * * * curl -X POST https://your-app.com/api/cron/analytics \\\\\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"//   -H \\\"Authorization: Bearer YOUR_CRON_SECRET\\\"\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"with-shopify-cli\",\"children\":\"With Shopify CLI\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Create cron job\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" app\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" generate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" cron\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Cron job route created at app/routes/api.cron.tsx\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"error-handling--retries\",\"children\":\"Error Handling \u0026 Retries\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"retry-logic\",\"children\":\"Retry Logic\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"ORDERS_CREATE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" processOrder\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"())\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Log error\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"      console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Webhook processing failed:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Return 5xx để Shopify retry\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Shopify sẽ retry với exponential backoff\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"        { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Processing failed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"        { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 503\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"retry-schedule\",\"children\":\"Retry Schedule\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Response\"}],[\"$\",\"th\",null,{\"children\":\"Action\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"200-299\"}],[\"$\",\"td\",null,{\"children\":\"Success - don't retry\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"400-499\"}],[\"$\",\"td\",null,{\"children\":\"Client error - don't retry\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"500-599\"}],[\"$\",\"td\",null,{\"children\":\"Server error - retry with backoff\"}]]}]]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Retry intervals:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 1: Immediately\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 2: ~2 seconds later\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 3: ~10 seconds later\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 4: ~1 hour later\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 5: ~12 hours later\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Attempt 6+: ~24 hours later\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"testing-webhooks\",\"children\":\"Testing Webhooks\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"local-testing\",\"children\":\"Local Testing\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Start dev server\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" app\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" dev\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# CLI provides ngrok URL\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Use it in Shopify webhook configuration\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"with-shopify-cli-1\",\"children\":\"With Shopify CLI\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Trigger test webhook\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" trigger\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"manual-testing\",\"children\":\"Manual Testing\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Send test webhook\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"curl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" -X\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" POST\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" https://your-app.com/webhooks/orders/create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\\\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  -H\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Content-Type: application/json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\\\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  -H\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"X-Shopify-Topic: orders/create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\\\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  -H\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"X-Shopify-Hmac-Sha256: CALCULATED_HMAC\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\\\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"  -d\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" '\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"{\\\"id\\\": \\\"gid://shopify/Order/123\\\", ...}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"'\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"monitoring\",\"children\":\"Monitoring\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"log-webhook-deliveries\",\"children\":\"Log Webhook Deliveries\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" startTime\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" processWebhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"())\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" duration\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" startTime\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Log success\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" logWebhookEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      duration\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" duration\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"-\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" startTime\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Log error\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" logWebhookEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"      duration\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"message\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"dashboard\",\"children\":\"Dashboard\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Admin UI để xem webhook status\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" webhookStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" getWebhookStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"webhookStats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" WebhookDashboard\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" useLoaderData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003ctypeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Webhook Status\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Card\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"        \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"BlockStack\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" gap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"400\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"          \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Total Webhooks: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"total\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"          \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" tone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Success: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"          \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" tone\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"critical\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Failed: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"failed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"          \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Average Duration: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"stats\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"avgDuration\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"ms\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Text\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"        \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"BlockStack\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Card\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"best-practices\",\"children\":\"Best Practices\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-quick-response\",\"children\":\"1. Quick Response\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ❌ BAD - Long processing\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" heavyProcessing\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\" // Takes 10 seconds\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ✅ GOOD - Queue job\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" queueJob\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\" // Returns immediately\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-idempotency\",\"children\":\"2. Idempotency\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Handle duplicate webhooks\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" processedWebhooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" webhookId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"admin_graphql_api_id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Check if already processed\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"processedWebhooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"has\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"webhookId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")) {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Already processed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" processWebhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  processedWebhooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"add\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"webhookId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-graceful-degradation\",\"children\":\"3. Graceful Degradation\"}],\"\\n\",[\"$\",\"figure\",null,{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" criticalOperation\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Log nhưng không fail webhook\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Operation failed:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" notifySupport\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Always return success\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"key-takeaways\",\"children\":\"Key Takeaways\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Webhooks\"}],\" - Real-time event notifications\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"HMAC verification\"}],\" - Built-in with authenticate.webhook()\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Background jobs\"}],\" - Queue heavy processing\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Quick response\"}],\" - Respond \u003c5 seconds\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Retries\"}],\" - Return 5xx for automatic retry\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"next-steps\",\"children\":\"Next Steps\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Trong \",[\"$\",\"strong\",null,{\"children\":\"Phần 10\"}],\", bạn sẽ học:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Testing strategies\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"CI/CD setup\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Deployment options\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"App Store submission\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/shopify-app-testing-deployment\",\"children\":\"Đọc Phần 10: Testing, Deployment \u0026 Launch →\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/shopify-theme-extensions\",\"children\":\"← Quay lại Phần 8: Theme Extensions\"}]}]]],null],null]},[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"shopify-webhooks-background-jobs\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"div\",null,{\"className\":\"\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"text-blue-500 hover:text-blue-700\",\"children\":\" Back to home\"}],[\"$\",\"article\",null,{\"className\":\"mt-4\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}]]}],null],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css\"}]}],[\"$\",\"body\",null,{\"className\":\"antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L7\"],\"globalErrorComponent\":\"$8\",\"missingSlots\":\"$W9\"}]]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Shopify Webhooks và Background Jobs - Hướng dẫn chi tiết\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Hướng dẫn xử lý webhooks, background jobs và cron tasks trong Shopify App.\"}]]\n3:null\n"])</script></body></html>