<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/5dfb718f68a2caf5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-82b2ba201d35e58a.js"/><script src="/_next/static/chunks/fd9d1056-be48aeae6e94b8d1.js" async=""></script><script src="/_next/static/chunks/23-a30630581d9d5727.js" async=""></script><script src="/_next/static/chunks/main-app-abc6aca9473c726e.js" async=""></script><script src="/_next/static/chunks/231-f5a29f791931326e.js" async=""></script><script src="/_next/static/chunks/app/blog/layout-a90c7b1536f7eb16.js" async=""></script><title>Database Design với MongoDB cho Shopify App - Hướng dẫn chi tiết</title><meta name="description" content="Hướng dẫn thiết kế database, implement Repository Pattern và sử dụng Mongoose cho Shopify App."/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16"><div class=""><a class="text-blue-500 hover:text-blue-700" href="/"> Back to home</a><article class="mt-4"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#giới-thiệu">Giới thiệu</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#tại-sao-mongodb-cho-shopify-apps">Tại sao MongoDB cho Shopify Apps?</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#ưu-điểm">Ưu điểm</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#schema-design-principles">Schema Design Principles</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-per-shop-data-isolation">1. Per-Shop Data Isolation</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-reference-vs-embedded">2. Reference vs Embedded</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#common-schemas">Common Schemas</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-config-schema">1. Config Schema</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-store-schema">2. Store Schema</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#3-analytics-schema">3. Analytics Schema</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#repository-pattern">Repository Pattern</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#implementation">Implementation</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#store-repository">Store Repository</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#mongodb-connection-management">MongoDB Connection Management</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#mongoose-connection">Mongoose Connection</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#data-validation">Data Validation</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#mongoose-validation">Mongoose Validation</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#zod-schema-validation">Zod Schema Validation</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#usage-in-routes">Usage in Routes</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#best-practices">Best Practices</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-use-indexes-wisely">1. Use Indexes Wisely</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-ttl-for-temporary-data">2. TTL for Temporary Data</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#3-connection-pooling">3. Connection Pooling</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#4-error-handling">4. Error Handling</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#key-takeaways">Key Takeaways</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#next-steps">Next Steps</a></li></ol></nav>
<h1 id="database-design-với-mongodb-cho-shopify-app">Database Design với MongoDB cho Shopify App</h1>
<h2 id="giới-thiệu">Giới thiệu</h2>
<p>Database là nơi lưu trữ configuration và data của app. Bài viết này sẽ hướng dẫn thiết kế schema hiệu quả cho Shopify App sử dụng MongoDB.</p>
<hr/>
<h2 id="tại-sao-mongodb-cho-shopify-apps">Tại sao MongoDB cho Shopify Apps?</h2>
<h3 id="ưu-điểm">Ưu điểm</h3>
<p><strong>1. Flexible Schema</strong></p>
<ul>
<li>Dễ dàng thêm fields mới</li>
<li>Khác nhau giữa các shops</li>
<li>Phù hợp cho SaaS apps</li>
</ul>
<p><strong>2. Scalability</strong></p>
<ul>
<li>Horizontal scaling</li>
<li>Sharding support</li>
<li>Cloud options (MongoDB Atlas)</li>
</ul>
<p><strong>3. Document Structure</strong></p>
<ul>
<li>Nested objects</li>
<li>Arrays support</li>
<li>JSON-like documents</li>
</ul>
<p><strong>4. Developer Friendly</strong></p>
<ul>
<li>JavaScript/TypeScript native</li>
<li>Mongoose ODM</li>
<li>Easy prototyping</li>
</ul>
<hr/>
<h2 id="schema-design-principles">Schema Design Principles</h2>
<h3 id="1-per-shop-data-isolation">1. Per-Shop Data Isolation</h3>
<p><strong>❌ BAD: Một collection cho tất cả data</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Không nên - data lẫn lộn</span></span>
<span data-line=""><span style="color:#B4C2F0">{</span></span>
<span data-line=""><span style="color:#FFC777">  shop</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shop1.myshopify.com</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">  type</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">config</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">  data</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#FF757F;font-weight:bold">...</span><span style="color:#B4C2F0">}</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<p><strong>✅ GOOD: Shop-specific models</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Nên - mỗi model cho một shop</span></span>
<span data-line=""><span style="color:#B4C2F0">{</span></span>
<span data-line=""><span style="color:#FFC777">  _id</span><span style="color:#86E1FC">:</span><span style="color:#65BCFF"> ObjectId</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">...</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">  shop</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shop1.myshopify.com</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#858AA6">  // Unique index</span></span>
<span data-line=""><span style="color:#FFC777">  settings</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#FF757F;font-weight:bold">...</span><span style="color:#B4C2F0">}</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="2-reference-vs-embedded">2. Reference vs Embedded</h3>
<p><strong>Embedded (thường tốt hơn):</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Product settings embedded trong config</span></span>
<span data-line=""><span style="color:#B4C2F0">{</span></span>
<span data-line=""><span style="color:#FFC777">  shop</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shop1.myshopify.com</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">  productSettings</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">    showPrice</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">    showVariant</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">    currency</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">USD</span><span style="color:#86E1FC">&quot;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<p><strong>Reference (khi data quá lớn):</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Reference sang analytics events</span></span>
<span data-line=""><span style="color:#B4C2F0">{</span></span>
<span data-line=""><span style="color:#FFC777">  shop</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shop1.myshopify.com</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FFC777">  eventIds</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#65BCFF">ObjectId</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">...</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span><span style="color:#65BCFF"> ObjectId</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">...</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">]</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="common-schemas">Common Schemas</h2>
<h3 id="1-config-schema">1. Config Schema</h3>
<p>Lưu trữ app configuration cho mỗi shop.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/models/config.model.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#C8D3F5"> mongoose</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Schema</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mongoose</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">interface</span><span style="color:#FFC777"> IConfig</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  settings</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    enabled</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    buttonColor</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    buttonTextColor</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    position</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">top</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> |</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bottom</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    borderRadius</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    padding</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    fontSize</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  themeExtension</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    enabled</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    themeId</span><span style="color:#86E1FC">?:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> configSchema</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Schema</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IConfig</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    required</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    unique</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  settings</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    enabled</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    buttonColor</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">#000000</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    buttonTextColor</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">#FFFFFF</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    position</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> enum</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">top</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bottom</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bottom</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    borderRadius</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">4px</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    padding</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">12px 24px</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    fontSize</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">16px</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  themeExtension</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    enabled</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    themeId</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now </span><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now </span><span style="color:#B4C2F0">}</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  timestamps</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#858AA6">  // Auto-manage createdAt, updatedAt</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Indexes</span></span>
<span data-line=""><span style="color:#FFC777">configSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">configSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">settings.enabled</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">configSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">themeExtension.enabled</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> Config</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">model</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IConfig</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Config</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> configSchema</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="2-store-schema">2. Store Schema</h3>
<p>Lưu trữ thông tin về shop và onboarding status.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/models/store.model.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#C8D3F5"> mongoose</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Schema</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mongoose</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">interface</span><span style="color:#FFC777"> IStore</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopName</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  contactEmail</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  primaryDomain</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopPlan</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  themeId</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Onboarding</span></span>
<span data-line=""><span style="color:#4FD6BE">  onboardingCompleted</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  onboardingStep</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> number</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // App status</span></span>
<span data-line=""><span style="color:#4FD6BE">  installedAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  uninstalledAt</span><span style="color:#86E1FC">?:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  isActive</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Review tracking</span></span>
<span data-line=""><span style="color:#4FD6BE">  hasReviewed</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  reviewTouchpoints</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    setupCompletedShown</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">    milestoneReachedShown</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> storeSchema</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Schema</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IStore</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    required</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    unique</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopName</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  contactEmail</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  primaryDomain</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopPlan</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  themeId</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#4FD6BE">  onboardingCompleted</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  onboardingStep</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Number</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 0</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#4FD6BE">  installedAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now </span><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  uninstalledAt</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  isActive</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#4FD6BE">  hasReviewed</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  reviewTouchpoints</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    setupCompletedShown</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    milestoneReachedShown</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Boolean</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now </span><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now </span><span style="color:#B4C2F0">}</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  timestamps</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> Store</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">model</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IStore</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Store</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> storeSchema</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="3-analytics-schema">3. Analytics Schema</h3>
<p>Lưu trữ analytics events với TTL để tự động cleanup.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/models/analytics.model.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#C8D3F5"> mongoose</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Schema</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mongoose</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">interface</span><span style="color:#FFC777"> IAnalyticsEvent</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  eventType</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">impression</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> |</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">click</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> |</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">add_to_cart</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> |</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">order</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  deviceType</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">desktop</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC"> |</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mobile</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  sessionId</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Event data</span></span>
<span data-line=""><span style="color:#4FD6BE">  productId</span><span style="color:#86E1FC">?:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  variantId</span><span style="color:#86E1FC">?:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  value</span><span style="color:#86E1FC">?:</span><span style="color:#FF966C"> number</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Timestamp</span></span>
<span data-line=""><span style="color:#4FD6BE">  timestamp</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // TTL index - auto delete sau 90 days</span></span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> analyticsSchema</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Schema</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IAnalyticsEvent</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  shop</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    required</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  eventType</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    enum</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">impression</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">click</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">add_to_cart</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">order</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span></span>
<span data-line=""><span style="color:#4FD6BE">    required</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  deviceType</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    enum</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">desktop</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mobile</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span></span>
<span data-line=""><span style="color:#4FD6BE">    required</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  sessionId</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  productId</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  variantId</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  value</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Number</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  timestamp</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> index</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> default</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Date</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">now</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> expires</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 7776000</span><span style="color:#B4C2F0"> }</span><span style="color:#858AA6"> // 90 days TTL</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  timestamps</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#858AA6">  // Don&#x27;t auto-update timestamps</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Compound indexes cho query performance</span></span>
<span data-line=""><span style="color:#FFC777">analyticsSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> timestamp</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> -</span><span style="color:#FF966C">1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">analyticsSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> eventType</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> timestamp</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> -</span><span style="color:#FF966C">1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">analyticsSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> sessionId</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> timestamp</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> AnalyticsEvent</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">model</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IAnalyticsEvent</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#86E1FC">  &quot;</span><span style="color:#C3E88D">AnalyticsEvent</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">  analyticsSchema</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="repository-pattern">Repository Pattern</h2>
<p>Repository Pattern tách biệt data access logic khỏi business logic.</p>
<h3 id="implementation">Implementation</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/repositories/config.repository.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Config</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../models/config.model</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOne</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> findOrCreate</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  let</span><span style="color:#C8D3F5"> config</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#65BCFF"> findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#C8D3F5">config</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C8D3F5">    config</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">create</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#C8D3F5"> config</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> update</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FCA7EA">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  data</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Partial</span><span style="color:#86E1FC">&lt;</span><span style="color:#FFC777">IConfig</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOneAndUpdate</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">$set</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#FF757F;font-weight:bold"> ...</span><span style="color:#C8D3F5">data</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Date</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> }</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">upsert</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> new</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> updateSettings</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FCA7EA">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  settings</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> IConfig</span><span style="color:#86E1FC">[</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">settings</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">]</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOneAndUpdate</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">$set</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#C8D3F5"> settings</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> updatedAt</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Date</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> }</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">new</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> deleteByShop</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">deleteOne</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> findAllActive</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Config</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">find</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#86E1FC">    &quot;</span><span style="color:#C3E88D">settings.enabled</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#86E1FC">    &quot;</span><span style="color:#C3E88D">themeExtension.enabled</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="store-repository">Store Repository</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/repositories/store.repository.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Store</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../models/store.model</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOne</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> findOrCreate</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  let</span><span style="color:#C8D3F5"> store</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#65BCFF"> findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#C8D3F5">store</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C8D3F5">    store</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">create</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#C8D3F5"> store</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> markInstalled</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> data</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopName</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  contactEmail</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  primaryDomain</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  themeId</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#4FD6BE">  shopPlan</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOneAndUpdate</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    {</span></span>
<span data-line=""><span style="color:#4FD6BE">      $set</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FF757F;font-weight:bold">        ...</span><span style="color:#C8D3F5">data</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        installedAt</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Date</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        isActive</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        uninstalledAt</span><span style="color:#86E1FC">:</span><span style="color:#7F85A3"> null</span></span>
<span data-line=""><span style="color:#B4C2F0">      }</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">upsert</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> new</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> markUninstalled</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOneAndUpdate</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    {</span></span>
<span data-line=""><span style="color:#4FD6BE">      $set</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">        isActive</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        uninstalledAt</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Date</span><span style="color:#B4C2F0">()</span></span>
<span data-line=""><span style="color:#B4C2F0">      }</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">new</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> updateOnboarding</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FCA7EA">  shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  step</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> number</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#FCA7EA">  completed</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> boolean</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOneAndUpdate</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    {</span></span>
<span data-line=""><span style="color:#4FD6BE">      $set</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">        onboardingStep</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> step</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">        onboardingCompleted</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> completed</span></span>
<span data-line=""><span style="color:#B4C2F0">      }</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    { </span><span style="color:#4FD6BE">new</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> getAllActive</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> Store</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">find</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">    isActive</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    onboardingCompleted</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="mongodb-connection-management">MongoDB Connection Management</h2>
<h3 id="mongoose-connection">Mongoose Connection</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/mongoose.server.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#C8D3F5"> mongoose </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">mongoose</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> MONGODB_URI</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">MONGODB_URI</span><span style="color:#86E1FC">!;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#FF98A4">MONGODB_URI</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  throw</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Error</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">MONGODB_URI is not defined</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Connection caching</span></span>
<span data-line=""><span style="color:#C099FF">let</span><span style="color:#C8D3F5"> cached </span><span style="color:#86E1FC">=</span><span style="color:#FFC777"> global</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">mongoose</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#C8D3F5">cached</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C8D3F5">  cached</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> global</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">mongoose</span><span style="color:#86E1FC"> =</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">conn</span><span style="color:#86E1FC">:</span><span style="color:#7F85A3"> null</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> promise</span><span style="color:#86E1FC">:</span><span style="color:#7F85A3"> null</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> connectToMongoDB</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#FFC777">cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">conn</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#FFC777"> cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">conn</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#FFC777">cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">promise</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#C099FF">    const</span><span style="color:#FF98A4"> opts</span><span style="color:#86E1FC"> =</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">      bufferCommands</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">    cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">promise</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">connect</span><span style="color:#B4C2F0">(</span><span style="color:#FF98A4">MONGODB_URI</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> opts</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">then</span><span style="color:#B4C2F0">((</span><span style="color:#FCA7EA">mongoose</span><span style="color:#B4C2F0">) </span><span style="color:#C099FF">=&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">      return</span><span style="color:#C8D3F5"> mongoose</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  try</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">    cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">conn</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">promise</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  } </span><span style="color:#86E1FC">catch</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">e</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#FFC777">    cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">promise</span><span style="color:#86E1FC"> =</span><span style="color:#7F85A3"> null</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">    throw</span><span style="color:#C8D3F5"> e</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#FFC777"> cached</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">conn</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// Event listeners</span></span>
<span data-line=""><span style="color:#FFC777">mongoose</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">connection</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">on</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">connected</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> ()</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">  console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">log</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">MongoDB connected successfully</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">mongoose</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">connection</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">on</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">error</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> (</span><span style="color:#FCA7EA">err</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">  console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">error</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">MongoDB connection error:</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> err</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">mongoose</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">connection</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">on</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">disconnected</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> ()</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">  console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">log</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">MongoDB disconnected</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="data-validation">Data Validation</h2>
<h3 id="mongoose-validation">Mongoose Validation</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> configSchema</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Schema</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  buttonColor</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    validate</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#82AAFF">      validator</span><span style="color:#86E1FC">:</span><span style="color:#C099FF"> function</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">v</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">        return</span><span style="color:#86E1FC"> /</span><span style="color:#C099FF">^</span><span style="color:#B4F9F8">#</span><span style="color:#86E1FC">[</span><span style="color:#FFC777">0-9A-F</span><span style="color:#86E1FC">]</span><span style="color:#FCA7EA">{6}</span><span style="color:#C099FF">$</span><span style="color:#86E1FC">/</span><span style="color:#C099FF">i</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">test</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">v</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">      }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#82AAFF">      message</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> (</span><span style="color:#FCA7EA">props</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#86E1FC"> `${</span><span style="color:#FFC777">props</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">value</span><span style="color:#86E1FC">}</span><span style="color:#C3E88D"> is not a valid hex color!</span><span style="color:#86E1FC">`</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  position</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> String</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    enum</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">      values</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">top</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bottom</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span></span>
<span data-line=""><span style="color:#4FD6BE">      message</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">{VALUE} is not supported</span><span style="color:#86E1FC">&quot;</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="zod-schema-validation">Zod Schema Validation</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/validators/config.validator.ts</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">z</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">zod</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> configSchema</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">object</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  buttonColor</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">string</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">regex</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">/</span><span style="color:#C099FF">^</span><span style="color:#B4F9F8">#</span><span style="color:#86E1FC">[</span><span style="color:#FFC777">0-9A-F</span><span style="color:#86E1FC">]</span><span style="color:#FCA7EA">{6}</span><span style="color:#C099FF">$</span><span style="color:#86E1FC">/</span><span style="color:#C099FF">i</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Invalid color format</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  position</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">enum</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">[</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">top</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">bottom</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#82AAFF">    errorMap</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> ()</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> ({</span><span style="color:#4FD6BE"> message</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Position must be &#x27;top&#x27; or &#x27;bottom&#x27;</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> })</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  enabled</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">boolean</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">default</span><span style="color:#B4C2F0">(</span><span style="color:#FF966C">false</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  borderRadius</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">string</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">optional</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  padding</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">string</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">optional</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  fontSize</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">string</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">optional</span><span style="color:#B4C2F0">()</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> type</span><span style="color:#FFC777"> ConfigInput</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> z</span><span style="color:#86E1FC">.</span><span style="color:#FFC777">infer</span><span style="color:#86E1FC">&lt;typeof</span><span style="color:#C8D3F5"> configSchema</span><span style="color:#86E1FC">&gt;;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> validateConfig</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">data</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> unknown</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#FFC777"> configSchema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">parse</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">data</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="usage-in-routes">Usage in Routes</h2>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/app.customizer.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> loader</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> LoaderFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">admin</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Repository pattern</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> config</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> configRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#C8D3F5">config</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> action</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">admin</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> formData</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> request</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">formData</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Validate</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> settings</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> validateConfig</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">    buttonColor</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> formData</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">get</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">buttonColor</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    position</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> formData</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">get</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">position</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    enabled</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> formData</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">get</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">enabled</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">true</span><span style="color:#86E1FC">&quot;</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Save</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> config</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> configRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">updateSettings</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> settings</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> config</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-use-indexes-wisely">1. Use Indexes Wisely</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// ✅ Good - Compound index</span></span>
<span data-line=""><span style="color:#FFC777">schema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> timestamp</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> -</span><span style="color:#FF966C">1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// ❌ Bad - Too many indexes</span></span>
<span data-line=""><span style="color:#FFC777">schema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">schema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> settings</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#FFC777">schema</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">index</span><span style="color:#B4C2F0">({</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> themeExtension</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="2-ttl-for-temporary-data">2. TTL for Temporary Data</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Auto delete sau 90 days</span></span>
<span data-line=""><span style="color:#86E1FC">new</span><span style="color:#65BCFF"> Schema</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  createdAt</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span><span style="color:#4FD6BE"> type</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> Date</span><span style="color:#86E1FC">,</span><span style="color:#4FD6BE"> expires</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 7776000</span><span style="color:#B4C2F0"> }</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="3-connection-pooling">3. Connection Pooling</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#FFC777">mongoose</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">connect</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">uri</span><span style="color:#86E1FC">,</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">  maxPoolSize</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 10</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  minPoolSize</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 5</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  socketTimeoutMS</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> 45000</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="4-error-handling">4. Error Handling</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">try</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> config</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> configRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findByShop</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC"> catch</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#86E1FC"> instanceof</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#FFC777">Error</span><span style="color:#86E1FC">.</span><span style="color:#FFC777">ValidationError</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#858AA6">    // Handle validation errors</span></span>
<span data-line=""><span style="color:#B4C2F0">  } </span><span style="color:#86E1FC">else</span><span style="color:#86E1FC"> if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">error</span><span style="color:#86E1FC"> instanceof</span><span style="color:#FFC777"> mongoose</span><span style="color:#86E1FC">.</span><span style="color:#FFC777">Error</span><span style="color:#86E1FC">.</span><span style="color:#FFC777">CastError</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#858AA6">    // Handle type errors</span></span>
<span data-line=""><span style="color:#B4C2F0">  } </span><span style="color:#86E1FC">else</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">    // Handle other errors</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="key-takeaways">Key Takeaways</h2>
<ol>
<li><strong>Per-shop isolation</strong> - Mỗi shop có document riêng</li>
<li><strong>Repository pattern</strong> - Tách biệt data access</li>
<li><strong>Indexes</strong> - Optimize query performance</li>
<li><strong>TTL</strong> - Auto cleanup temporary data</li>
<li><strong>Validation</strong> - Mongoose + Zod combo</li>
</ol>
<hr/>
<h2 id="next-steps">Next Steps</h2>
<p>Trong <strong>Phần 7</strong>, bạn sẽ học:</p>
<ul>
<li>Shopify GraphQL API</li>
<li>Querying products, orders</li>
<li>Mutations</li>
<li>Rate limiting</li>
</ul>
<p><a href="/blog/shopify-api-integration">Đọc Phần 7: Shopify API Integration →</a></p>
<p><a href="/blog/xay-dung-admin-ui-remix-polaris">← Quay lại Phần 5: Admin UI</a></p></article></div><script src="/_next/static/chunks/webpack-82b2ba201d35e58a.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/5dfb718f68a2caf5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n4:I[9275,[],\"\"]\n5:I[1343,[],\"\"]\n6:I[231,[\"231\",\"static/chunks/231-f5a29f791931326e.js\",\"768\",\"static/chunks/app/blog/layout-a90c7b1536f7eb16.js\"],\"\"]\n8:I[6130,[],\"\"]\n9:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5dfb718f68a2caf5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"TGxWRb6e7ui63GHvPI7L9\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/shopify-app-database-mongodb\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-app-database-mongodb\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-app-database-mongodb\",{\"children\":[\"__PAGE__\",{},[[\"$L3\",[[\"$\",\"nav\",null,{\"className\":\"toc\",\"children\":[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-1\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#giới-thiệu\",\"children\":\"Giới thiệu\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#tại-sao-mongodb-cho-shopify-apps\",\"children\":\"Tại sao MongoDB cho Shopify Apps?\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#ưu-điểm\",\"children\":\"Ưu điểm\"}]}]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#schema-design-principles\",\"children\":\"Schema Design Principles\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#1-per-shop-data-isolation\",\"children\":\"1. Per-Shop Data Isolation\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#2-reference-vs-embedded\",\"children\":\"2. Reference vs Embedded\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#common-schemas\",\"children\":\"Common Schemas\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#1-config-schema\",\"children\":\"1. Config Schema\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#2-store-schema\",\"children\":\"2. Store Schema\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#3-analytics-schema\",\"children\":\"3. Analytics Schema\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#repository-pattern\",\"children\":\"Repository Pattern\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#implementation\",\"children\":\"Implementation\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#store-repository\",\"children\":\"Store Repository\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#mongodb-connection-management\",\"children\":\"MongoDB Connection Management\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#mongoose-connection\",\"children\":\"Mongoose Connection\"}]}]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#data-validation\",\"children\":\"Data Validation\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#mongoose-validation\",\"children\":\"Mongoose Validation\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#zod-schema-validation\",\"children\":\"Zod Schema Validation\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#usage-in-routes\",\"children\":\"Usage in Routes\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#best-practices\",\"children\":\"Best Practices\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#1-use-indexes-wisely\",\"children\":\"1. Use Indexes Wisely\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#2-ttl-for-temporary-data\",\"children\":\"2. TTL for Temporary Data\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#3-connection-pooling\",\"children\":\"3. Connection Pooling\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#4-error-handling\",\"children\":\"4. Error Handling\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#key-takeaways\",\"children\":\"Key Takeaways\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#next-steps\",\"children\":\"Next Steps\"}]}]]}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"database-design-với-mongodb-cho-shopify-app\",\"children\":\"Database Design với MongoDB cho Shopify App\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"giới-thiệu\",\"children\":\"Giới thiệu\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Database là nơi lưu trữ configuration và data của app. Bài viết này sẽ hướng dẫn thiết kế schema hiệu quả cho Shopify App sử dụng MongoDB.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"tại-sao-mongodb-cho-shopify-apps\",\"children\":\"Tại sao MongoDB cho Shopify Apps?\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"ưu-điểm\",\"children\":\"Ưu điểm\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"1. Flexible Schema\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Dễ dàng thêm fields mới\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Khác nhau giữa các shops\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Phù hợp cho SaaS apps\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"2. Scalability\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Horizontal scaling\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Sharding support\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Cloud options (MongoDB Atlas)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"3. Document Structure\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Nested objects\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Arrays support\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"JSON-like documents\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"4. Developer Friendly\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"JavaScript/TypeScript native\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Mongoose ODM\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Easy prototyping\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"schema-design-principles\",\"children\":\"Schema Design Principles\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-per-shop-data-isolation\",\"children\":\"1. Per-Shop Data Isolation\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"❌ BAD: Một collection cho tất cả data\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Không nên - data lẫn lộn\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shop1.myshopify.com\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\",\"fontWeight\":\"bold\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"✅ GOOD: Shop-specific models\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Nên - mỗi model cho một shop\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  _id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" ObjectId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shop1.myshopify.com\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Unique index\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\",\"fontWeight\":\"bold\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-reference-vs-embedded\",\"children\":\"2. Reference vs Embedded\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Embedded (thường tốt hơn):\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Product settings embedded trong config\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shop1.myshopify.com\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  productSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    showPrice\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    showVariant\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    currency\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"USD\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Reference (khi data quá lớn):\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Reference sang analytics events\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shop1.myshopify.com\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  eventIds\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"ObjectId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" ObjectId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"common-schemas\",\"children\":\"Common Schemas\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-config-schema\",\"children\":\"1. Config Schema\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Lưu trữ app configuration cho mỗi shop.\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/models/config.model.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"interface\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" IConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    buttonTextColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"top\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bottom\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    borderRadius\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    padding\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    fontSize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  themeExtension\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    themeId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    required\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    unique\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"#000000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    buttonTextColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"#FFFFFF\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"top\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bottom\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bottom\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    borderRadius\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"4px\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    padding\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"12px 24px\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    fontSize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"16px\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  themeExtension\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    themeId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  timestamps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Auto-manage createdAt, updatedAt\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Indexes\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"settings.enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"themeExtension.enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-store-schema\",\"children\":\"2. Store Schema\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Lưu trữ thông tin về shop và onboarding status.\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/models/store.model.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"interface\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" IStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  contactEmail\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  primaryDomain\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopPlan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  themeId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Onboarding\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  onboardingCompleted\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  onboardingStep\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // App status\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  installedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  uninstalledAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  isActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Review tracking\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  hasReviewed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  reviewTouchpoints\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    setupCompletedShown\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    milestoneReachedShown\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" storeSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    required\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    unique\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  contactEmail\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  primaryDomain\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopPlan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  themeId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  onboardingCompleted\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  onboardingStep\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 0\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  installedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  uninstalledAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  isActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  hasReviewed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  reviewTouchpoints\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    setupCompletedShown\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    milestoneReachedShown\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  timestamps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" storeSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-analytics-schema\",\"children\":\"3. Analytics Schema\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Lưu trữ analytics events với TTL để tự động cleanup.\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/models/analytics.model.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"interface\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" IAnalyticsEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  eventType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"impression\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"click\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"add_to_cart\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  deviceType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"desktop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" |\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mobile\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  sessionId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Event data\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  productId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  variantId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"?:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Timestamp\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // TTL index - auto delete sau 90 days\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" analyticsSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IAnalyticsEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    required\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  eventType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"impression\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"click\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"add_to_cart\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"order\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    required\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  deviceType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"desktop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mobile\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    required\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  sessionId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  productId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  variantId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" expires\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 7776000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\" // 90 days TTL\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  timestamps\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Don't auto-update timestamps\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Compound indexes cho query performance\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"analyticsSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" -\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"analyticsSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" eventType\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" -\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"analyticsSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" sessionId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" AnalyticsEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IAnalyticsEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"AnalyticsEvent\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  analyticsSchema\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"repository-pattern\",\"children\":\"Repository Pattern\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Repository Pattern tách biệt data access logic khỏi business logic.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"implementation\",\"children\":\"Implementation\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/repositories/config.repository.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../models/config.model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOne\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" findOrCreate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" update\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Partial\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"IConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOneAndUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"$$set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\",\"fontWeight\":\"bold\"},\"children\":\" ...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"upsert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" updateSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" IConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"]\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOneAndUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"$$set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" updatedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" deleteByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"deleteOne\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" findAllActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"find\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"settings.enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"themeExtension.enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"store-repository\",\"children\":\"Store Repository\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/repositories/store.repository.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../models/store.model\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOne\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" findOrCreate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" markInstalled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopName\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  contactEmail\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  primaryDomain\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  themeId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  shopPlan\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOneAndUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      $set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\",\"fontWeight\":\"bold\"},\"children\":\"        ...\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        installedAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        isActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        uninstalledAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7F85A3\"},\"children\":\" null\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"upsert\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" markUninstalled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOneAndUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      $set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        isActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        uninstalledAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" updateOnboarding\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" number\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  completed\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" boolean\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOneAndUpdate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      $set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        onboardingStep\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" step\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"        onboardingCompleted\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" completed\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" getAllActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Store\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"find\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    isActive\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    onboardingCompleted\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"mongodb-connection-management\",\"children\":\"MongoDB Connection Management\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"mongoose-connection\",\"children\":\"Mongoose Connection\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/mongoose.server.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" mongoose \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" MONGODB_URI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"MONGODB_URI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"MONGODB_URI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"MONGODB_URI is not defined\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Connection caching\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"let\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" cached \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" global\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" global\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"conn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7F85A3\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7F85A3\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" connectToMongoDB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"conn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"conn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"    const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" opts\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      bufferCommands\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"connect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"MONGODB_URI\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" opts\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"then\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"conn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"    cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#7F85A3\"},\"children\":\" null\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" cached\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"conn\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Event listeners\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"on\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"connected\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" ()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"MongoDB connected successfully\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"on\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"err\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"MongoDB connection error:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" err\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"connection\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"on\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"disconnected\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" ()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"MongoDB disconnected\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"data-validation\",\"children\":\"Data Validation\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"mongoose-validation\",\"children\":\"Mongoose Validation\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    validate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\"      validator\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"v\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"        return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" /\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"^\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4F9F8\"},\"children\":\"#\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"0-9A-F\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"{6}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"$$\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"test\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"v\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"      }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\"      message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" `${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"props\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"value\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" is not a valid hex color!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" String\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      values\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"top\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bottom\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"{VALUE} is not supported\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"zod-schema-validation\",\"children\":\"Zod Schema Validation\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/validators/config.validator.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"zod\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"object\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"regex\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"^\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4F9F8\"},\"children\":\"#\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"0-9A-F\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"]\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"{6}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"$$\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"i\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Invalid color format\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"enum\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"top\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"bottom\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\"    errorMap\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" ()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" ({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Position must be 'top' or 'bottom'\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"boolean\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\"false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  borderRadius\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"optional\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  padding\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"optional\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  fontSize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"optional\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ConfigInput\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" z\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"infer\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003ctypeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" validateConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" unknown\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configSchema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"parse\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"usage-in-routes\",\"children\":\"Usage in Routes\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/app.customizer.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Repository pattern\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" formData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"formData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Validate\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" validateConfig\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" formData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"buttonColor\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" formData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"position\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" formData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"get\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"enabled\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Save\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"updateSettings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"best-practices\",\"children\":\"Best Practices\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-use-indexes-wisely\",\"children\":\"1. Use Indexes Wisely\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ✅ Good - Compound index\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" timestamp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" -\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\"1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ❌ Bad - Too many indexes\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" settings\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" themeExtension\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-ttl-for-temporary-data\",\"children\":\"2. TTL for Temporary Data\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Auto delete sau 90 days\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Schema\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  createdAt\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Date\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" expires\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 7776000\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-connection-pooling\",\"children\":\"3. Connection Pooling\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"connect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"uri\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  maxPoolSize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 10\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  minPoolSize\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 5\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  socketTimeoutMS\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 45000\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"4-error-handling\",\"children\":\"4. Error Handling\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"try\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findByShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" catch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" instanceof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"ValidationError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Handle validation errors\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" instanceof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" mongoose\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"CastError\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Handle type errors\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Handle other errors\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"key-takeaways\",\"children\":\"Key Takeaways\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Per-shop isolation\"}],\" - Mỗi shop có document riêng\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Repository pattern\"}],\" - Tách biệt data access\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Indexes\"}],\" - Optimize query performance\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"TTL\"}],\" - Auto cleanup temporary data\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Validation\"}],\" - Mongoose + Zod combo\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"next-steps\",\"children\":\"Next Steps\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Trong \",[\"$\",\"strong\",null,{\"children\":\"Phần 7\"}],\", bạn sẽ học:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Shopify GraphQL API\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Querying products, orders\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Mutations\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Rate limiting\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/shopify-api-integration\",\"children\":\"Đọc Phần 7: Shopify API Integration →\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/xay-dung-admin-ui-remix-polaris\",\"children\":\"← Quay lại Phần 5: Admin UI\"}]}]]],null],null]},[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"shopify-app-database-mongodb\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"div\",null,{\"className\":\"\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"text-blue-500 hover:text-blue-700\",\"children\":\" Back to home\"}],[\"$\",\"article\",null,{\"className\":\"mt-4\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}]]}],null],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css\"}]}],[\"$\",\"body\",null,{\"className\":\"antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16\",\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L7\"],\"globalErrorComponent\":\"$8\",\"missingSlots\":\"$W9\"}]]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Database Design với MongoDB cho Shopify App - Hướng dẫn chi tiết\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Hướng dẫn thiết kế database, implement Repository Pattern và sử dụng Mongoose cho Shopify App.\"}]]\n3:null\n"])</script></body></html>