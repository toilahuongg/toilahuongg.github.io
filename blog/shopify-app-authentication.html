<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/5dfb718f68a2caf5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-82b2ba201d35e58a.js"/><script src="/_next/static/chunks/fd9d1056-be48aeae6e94b8d1.js" async=""></script><script src="/_next/static/chunks/23-a30630581d9d5727.js" async=""></script><script src="/_next/static/chunks/main-app-abc6aca9473c726e.js" async=""></script><script src="/_next/static/chunks/app/blog/shopify-app-authentication/page-c7afc5646a7bb2c5.js" async=""></script><script src="/_next/static/chunks/231-f5a29f791931326e.js" async=""></script><script src="/_next/static/chunks/app/blog/layout-a90c7b1536f7eb16.js" async=""></script><title>Authentication &amp; Authorization trong Shopify App - Hướng dẫn chi tiết</title><meta name="description" content="Tìm hiểu về OAuth flow, session management, access tokens và securing Shopify App của bạn."/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16"><div class=""><a class="text-blue-500 hover:text-blue-700" href="/"> Back to home</a><article class="mt-4"><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#giới-thiệu">Giới thiệu</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#shopify-oauth-flow">Shopify OAuth Flow</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#overview">Overview</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#chi-tiết-từng-bước">Chi tiết từng bước</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#implementation-với-shopify-app-remix">Implementation với Shopify App Remix</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#shopifyserverts-configuration">shopify.server.ts Configuration</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#session-storage-options">Session Storage Options</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#scopes---quyền-truy-cập-app">Scopes - Quyền truy cập App</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#scopes-phổ-biến">Scopes phổ biến</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#best-practices">Best Practices</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#sử-dụng-authentication-trong-routes">Sử dụng Authentication trong Routes</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#protected-routes-admin-ui">Protected Routes (Admin UI)</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#public-api-routes">Public API Routes</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#webhook-authentication">Webhook Authentication</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#security-best-practices">Security Best Practices</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#1-environment-variables">1. Environment Variables</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#2-https-cho-production">2. HTTPS cho Production</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#3-session-validation">3. Session Validation</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#4-rate-limiting">4. Rate Limiting</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#real-world-example">Real-world Example</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#testing-authentication">Testing Authentication</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#test-với-development-store">Test với Development Store</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#test-session-expiry">Test Session Expiry</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#common-issues">Common Issues</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#issue-invalid-hmac-signature">Issue: &quot;Invalid HMAC signature&quot;</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#issue-session-not-found">Issue: &quot;Session not found&quot;</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#issue-access-denied">Issue: &quot;Access denied&quot;</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#key-takeaways">Key Takeaways</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#tài-nguyên-tham-khảo">Tài nguyên tham khảo</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#next-steps">Next Steps</a></li></ol></nav>
<h1 id="authentication--authorization-trong-shopify-app">Authentication &amp; Authorization trong Shopify App</h1>
<h2 id="giới-thiệu">Giới thiệu</h2>
<p>Authentication là hàng rào bảo vệ đầu tiên cho Shopify App của bạn. Bài viết này sẽ giải thích cách Shopify OAuth hoạt động và cách implement secure authentication.</p>
<hr/>
<h2 id="shopify-oauth-flow">Shopify OAuth Flow</h2>
<h3 id="overview">Overview</h3>
<p>Khi merchant cài đặt app của bạn, Shopify sẽ redirect họ qua app để xác thực quyền truy cập.</p>
<div class="mermaid-wrapper cursor-pointer" title="Click to zoom"><svg xmlns="http://www.w3.org/2000/svg" id="m05614617120579222-0" width="100%" aria-roledescription="sequence" style="font-family:arial,sans-serif;font-size:16px;fill:#ccc;max-width:1176px" viewBox="-50 -10 1176 435"><rect width="150" height="65" x="926" y="349" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"></rect><text x="1001" y="381.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="1001" dy="0">Shopify API</tspan></text><rect width="150" height="65" x="522" y="349" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"></rect><text x="597" y="381.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="597" dy="0">Your App</tspan></text><rect width="150" height="65" x="200" y="349" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"></rect><text x="275" y="381.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="275" dy="0">Shopify Admin</tspan></text><rect width="150" height="65" y="349" fill="#eaeaea" stroke="#666" class="actor actor-bottom" rx="3" ry="3"></rect><text x="75" y="381.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="75" dy="0">Merchant</tspan></text><line id="actor3" x1="1001" x2="1001" y1="65" y2="349" stroke="#999" stroke-width=".5" class="actor-line 200"></line><g id="root-3"><rect width="150" height="65" x="926" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"></rect><text x="1001" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="1001" dy="0">Shopify API</tspan></text></g><line id="actor2" x1="597" x2="597" y1="65" y2="349" stroke="#999" stroke-width=".5" class="actor-line 200"></line><g id="root-2"><rect width="150" height="65" x="522" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"></rect><text x="597" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="597" dy="0">Your App</tspan></text></g><line id="actor1" x1="275" x2="275" y1="65" y2="349" stroke="#999" stroke-width=".5" class="actor-line 200"></line><g id="root-1"><rect width="150" height="65" x="200" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"></rect><text x="275" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="275" dy="0">Shopify Admin</tspan></text></g><line id="actor0" x1="75" x2="75" y1="65" y2="349" stroke="#999" stroke-width=".5" class="actor-line 200"></line><g id="root-0"><rect width="150" height="65" fill="#eaeaea" stroke="#666" class="actor actor-top" rx="3" ry="3"></rect><text x="75" y="32.5" alignment-baseline="central" class="actor actor-box" dominant-baseline="central" style="text-anchor:middle;font-size:16px;font-weight:400;font-family:arial,sans-serif"><tspan x="75" dy="0">Merchant</tspan></text></g><style>@keyframes edge-animation-frame{0%{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#m05614617120579222-0 svg{font-family:arial,sans-serif;font-size:16px}#m05614617120579222-0 .actor{stroke:#ccc;fill:#1f2020}#m05614617120579222-0 text.actor&gt;tspan{fill:#d3d3d3;stroke:none}#m05614617120579222-0 .actor-line{stroke:#ccc}#m05614617120579222-0 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#d3d3d3}#m05614617120579222-0 .messageText{fill:#d3d3d3;stroke:none}#m05614617120579222-0 line{stroke:#ccc;fill:#1f2020;stroke-width:2px}#m05614617120579222-0 :root{--mermaid-font-family:arial,sans-serif}</style><defs><symbol id="computer"><path d="M1 1v6.5h10V1zm9 5.5H2V2h8zm-5.114 3 .233-.5h1.762l.234.5zM12 11H0l1-3h1.052l-.665 2h9.225l-.648-2H11zM9.5 6h-7V2.5h7z"></path></symbol></defs><defs><symbol id="database" fill-rule="evenodd" clip-rule="evenodd"><path d="m6.129 0 .128.003.128.002.126.004.126.005.124.006.124.008.123.008.12.009.121.01.12.012.118.012.116.013.116.014.114.016.113.016.111.017.11.018.109.019.106.02.106.02.104.021.102.023.101.023.099.024.097.025.095.026L9.18.4l.091.027.09.028.088.029.086.029.084.03.081.03.08.032.078.032.075.033.037.017.036.016.036.017.035.017.034.018.034.017.034.018.033.017.032.018.032.018.031.018.03.018.03.019.029.018.029.019.027.018.028.02.026.019.026.019.026.019.025.02.024.019.023.02.023.02.022.02.021.02.021.02.02.02.02.02.018.021.018.02.017.021.016.021.016.021.015.021.015.021.013.021.013.021.012.022.012.021.01.022.01.022.01.022.008.021.007.022.007.022.006.022.006.023.004.022.004.022.003.023.002.022v.023L11 1.75v8.523l-.001.022-.002.023-.003.022-.004.023-.004.022-.006.022-.006.022-.006.022-.008.022-.009.022-.009.022-.01.021-.01.022-.012.021-.012.022-.013.021-.013.021-.015.021-.015.021-.016.021-.016.021-.017.02-.018.021-.019.02-.019.021-.02.02-.02.02-.022.02-.022.02-.023.02-.023.02-.024.02-.025.019-.026.02-.026.019-.026.019-.028.019-.027.019-.029.018-.029.019-.03.018-.03.018-.031.018-.032.018-.032.018-.033.018-.034.017-.034.018-.034.017-.035.017-.036.017-.036.017-.037.016-.075.033-.078.032-.08.032-.081.03-.084.03-.086.03-.088.028-.09.028-.091.027-.094.027-.095.025-.097.025-.099.024-.1.023-.103.023-.104.021-.106.02-.107.02-.108.02-.11.018-.111.017-.113.016-.114.015-.116.014-.116.014-.118.012-.12.011-.12.01-.121.01-.123.008-.124.007-.124.006-.126.005-.126.004-.128.003-.128.002h-.258l-.128-.002-.127-.003-.127-.004-.125-.005-.125-.006-.123-.007-.123-.008-.121-.01-.121-.01-.119-.011-.118-.012-.117-.014-.115-.014-.114-.015-.113-.016-.112-.017-.11-.018-.108-.02-.107-.02-.106-.02-.104-.021-.102-.023-.1-.023-.1-.024-.097-.025-.095-.025-.094-.027-.092-.027-.089-.028-.088-.028-.086-.03-.084-.03-.082-.03-.079-.032-.078-.032-.075-.033-.037-.016-.036-.017-.036-.017-.035-.017-.035-.017-.034-.018-.033-.017-.033-.018-.032-.018-.032-.018-.03-.018-.031-.018-.03-.018-.029-.019-.029-.018-.028-.02-.027-.018-.027-.02-.026-.018-.025-.02-.025-.02-.024-.019-.023-.02-.023-.02-.022-.02-.021-.02-.021-.02-.02-.02-.02-.02-.018-.021-.018-.02-.017-.021-.016-.021-.016-.021-.015-.021-.015-.021-.013-.021-.013-.021-.012-.022-.012-.021-.01-.022-.01-.021-.01-.022-.008-.022-.007-.022-.007-.022-.006-.022-.005-.022-.005-.022-.003-.023-.003-.022-.002-.023L1 10.273 1 10.25V1.728l.002-.023.002-.022.003-.023.003-.022.005-.022.005-.023.006-.022.007-.022.007-.022.009-.021.009-.022.01-.022.01-.021.012-.022.012-.022.013-.021.013-.021.015-.021.015-.021.016-.021.016-.021.017-.02.018-.021.018-.02.02-.021.02-.02.02-.02.022-.02.022-.02.023-.02.023-.02.024-.02.025-.019.025-.02.026-.019.027-.019.027-.019.028-.019.029-.018.029-.019.03-.018.03-.018.031-.018.032-.018.032-.018.033-.018.033-.017.034-.017.035-.018.035-.017.036-.017.036-.016.037-.017.075-.033.078-.032.08-.031.081-.031.084-.03.086-.03.088-.028.09-.028L2.82.4l.094-.026.095-.026.098-.025.098-.024.101-.023.102-.023.104-.021.106-.02.107-.02.108-.02.11-.017.112-.017.113-.016.114-.016.115-.014.117-.013.118-.012.119-.012.12-.01.122-.01.123-.007.123-.008.125-.006.125-.005.127-.004.127-.002L5.871 0 6 0zM1.5 10.25v.015l.002.011.002.011.003.01.003.012.003.01.005.012.004.011.006.011.006.012.006.011.008.012.008.012.008.011.01.012.009.012.01.012.011.013.012.012.012.013.026.024.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.025.053.026.055.026.057.026.059.025.062.026.063.025.066.025.067.025.07.024.072.024.073.024.076.023.078.024.08.022.081.023.084.021.085.022.088.02.089.021.092.02.093.019.095.018.097.018.099.017.1.017.103.015.104.015.106.015.108.013.11.013.11.012.114.01.115.01.116.01.118.007.12.008.122.006.123.005.124.004.127.002.128.002L6 11.5h.13l.129-.003.127-.002.125-.004.123-.006.122-.006.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.013.108-.013.106-.014.105-.016.103-.015.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.025.066-.025.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.025.046-.027.044-.026.041-.025.04-.026.037-.026.035-.026.032-.025.03-.026.028-.025.026-.025.011-.012.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V8.187l-.038.027-.04.027-.042.027-.042.026-.044.026-.045.026-.046.026-.048.025-.048.025-.05.024-.051.025-.053.024-.053.023-.054.024-.056.023-.057.022-.057.023-.06.022-.06.021-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.019-.07.017-.07.018-.072.017-.072.016-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 9.028l-.08.012-.081.011-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.003-.091.003-.091.002-.092.001-.092.001h-.185l-.092-.001-.092-.001-.091-.002-.091-.003-.091-.003-.09-.004-.089-.004-.089-.005-.088-.005-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.011L4 9.028l-.08-.013-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.016-.071-.017-.071-.018-.07-.017-.068-.019-.068-.018-.067-.02-.066-.018-.065-.02-.064-.02-.063-.021-.062-.021-.061-.021-.06-.022-.059-.021-.058-.023-.056-.022-.056-.023-.055-.024-.053-.023-.052-.024-.051-.025-.05-.024-.049-.025-.047-.025-.047-.026-.045-.026-.043-.026-.043-.026-.041-.027-.04-.027-.039-.027zm0-2.827v.016l.002.01.002.011.003.011.003.011.003.011.005.011.004.011.006.012.006.011.006.012.008.012.008.011.008.012.01.012.009.012.01.012.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.053.026.055.025.057.026.059.026.062.025.063.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.022.085.021.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.011.115.01.116.009.118.008.12.007.122.006.123.005.124.004.127.003.128.001.129.001h.13l.129-.002.127-.003.125-.004.123-.005.122-.006.12-.008.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.025.063-.026.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.025.035-.026.032-.026.03-.025.028-.025.026-.025.011-.012.012-.012.01-.013.01-.012.01-.012.009-.012.008-.012.008-.011.007-.012.006-.012.006-.01.005-.012.005-.012.004-.01.003-.012.003-.01.002-.011.002-.011v-.01l.001-.011v-2.07l-.038.027-.04.027-.042.027-.042.026-.044.027-.045.025-.046.026-.048.025-.048.025-.05.025-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.018-.068.019-.069.018-.07.018-.07.017-.072.017-.072.016-.073.017-.074.015-.075.015-.076.015-.076.014-.077.014-.078.014-.08.013L8 6.194l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.008-.085.008-.087.008-.086.007-.088.006-.087.006-.089.006-.089.004-.09.005-.089.003-.09.004-.091.002-.091.002-.092.002-.092.001h-.185l-.092-.001-.092-.002-.091-.002-.091-.002-.091-.004-.09-.003-.089-.005-.089-.004-.088-.006-.088-.006L4.92 6.3l-.087-.007-.086-.008-.085-.008-.085-.008-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 6.194l-.08-.012-.078-.013-.078-.014-.077-.014-.077-.014-.075-.015-.075-.015-.074-.015-.073-.017-.073-.016-.071-.017-.071-.017-.07-.018-.068-.018-.068-.019-.067-.019-.066-.019-.065-.02-.064-.02-.063-.02-.062-.021-.061-.022-.06-.021-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.023-.052-.025-.051-.024-.05-.025-.049-.025-.047-.025-.047-.026-.045-.025-.043-.027-.043-.026-.041-.027-.04-.027-.039-.027zm0-2.833v.016l.002.01.002.011.003.011.003.01.003.012.005.011.004.011.006.012.006.011.006.012.008.011.008.012.008.012.01.011.009.012.01.013.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.053.025.055.026.057.026.059.025.062.026.063.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.021.085.022.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.01.115.01.116.01.118.008.12.007.122.006.123.005.124.004.127.003.128.001L6 5.84h.13l.129-.002.127-.003.125-.004.123-.005.122-.007.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.026.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.025.032-.025.03-.026.028-.025.026-.025.011-.012.012-.013.01-.012.01-.012.01-.011.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V2.514l-.038.027-.04.027-.042.026-.042.027-.044.026-.045.026-.046.025-.048.026-.048.025-.05.024-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.018-.07.018-.07.017-.072.017-.072.017-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 3.354l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.002-.091.004-.091.002-.092.001h-.092L6 3.5h-.092l-.092-.001-.092-.001-.091-.003-.091-.002-.091-.003-.09-.004-.089-.004-.089-.006-.088-.004-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 3.354l-.08-.012-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.017-.071-.017-.071-.017-.07-.018-.068-.018-.068-.018-.067-.02-.066-.019-.065-.02-.064-.02-.063-.02L2.505 3l-.061-.021-.06-.022-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.024-.052-.024-.051-.024-.05-.025-.049-.024-.047-.026-.047-.025-.045-.026-.043-.026-.043-.027-.041-.026-.04-.027-.039-.027zM5.87.5l-.128.002-.127.003-.125.004-.124.005-.122.006-.12.007-.119.008-.116.01-.116.01-.113.011-.112.011-.11.013-.108.014-.106.014-.105.015-.102.016-.102.017-.099.017-.097.018-.095.019-.094.019-.091.02-.09.02L3.262.8l-.086.022-.084.021-.082.023-.08.023-.077.023-.076.024-.074.024-.072.024-.069.024-.068.025-.066.025-.063.026-.061.025-.059.026-.057.026-.055.026-.053.026-.05.026-.049.026-.046.026-.044.026-.041.026-.04.026-.037.025-.035.026-.032.026-.03.025-.028.025-.026.025-.011.012-.012.012-.01.012-.01.013-.01.012-.009.012-.008.011-.008.012-.007.012-.006.011-.006.012-.005.012-.005.01-.004.011-.003.012-.003.01-.002.011-.002.011v.01L1.5 1.75v.01l.001.011.002.01.002.011.003.011.003.011.004.011.005.011.005.012.006.011.006.012.007.011.008.012.008.012.01.012.009.012.01.012.01.012.012.012.011.013.026.025.028.025.03.025.032.025.035.026.037.026.04.026.041.026.044.026.046.026.048.026.051.026.053.026.055.026.057.026.059.025.061.026.063.025.066.025.068.025.07.025.071.024.074.024.076.024.077.023.08.023.082.022.084.022.086.021.087.021.09.021.091.02.094.019.095.019.097.018.1.017.1.016.103.016.105.016.106.014.108.013.11.013.112.012.113.011.116.01.116.01.119.007.12.007.122.006.124.006.125.004.127.002L5.87 3 6 3h.13l.129-.003.126-.002.125-.004.124-.006.122-.006.12-.007.119-.008.116-.009.116-.01.113-.011.112-.012.11-.013.108-.013.106-.014.105-.016.103-.016.1-.016.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.022.086-.021.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.025.066-.025.063-.025.061-.026.059-.025.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.026.032-.025.03-.025.028-.025.026-.025.011-.013.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.008-.012.007-.011.006-.012.006-.011.005-.012.005-.01.004-.012.003-.011.003-.01.002-.012.002-.01v-.01l.001-.011v-.01l-.001-.011-.002-.01-.002-.012-.003-.01-.003-.011-.004-.011-.005-.011-.005-.012-.006-.011-.006-.012-.007-.011-.008-.013-.008-.011-.01-.012-.009-.012-.01-.013-.01-.012-.012-.012-.011-.012-.026-.025-.028-.025-.03-.025-.032-.025-.035-.026-.037-.026-.04-.026-.041-.026-.044-.026-.046-.026-.048-.026-.051-.026-.053-.026-.055-.026-.057-.026-.059-.026-.061-.025-.063-.026-.066-.025-.068-.025-.07-.024L9.298.96 9.223.936 9.147.912 9.07.889 8.99.866 8.907.843 8.824.822 8.738.8 8.651.78 8.56.758 8.47.739 8.376.72 8.281.701 8.182.683 8.086.666 7.983.649 7.882.633 7.776.618 7.67.604 7.562.59l-.11-.013L7.34.566 7.227.555l-.116-.01-.116-.01-.119-.008-.12-.007-.122-.006L6.51.51 6.385.505 6.259.502 6.13.5h-.26"></path></symbol></defs><defs><symbol id="clock"><path d="M6 1c2.757 0 5 2.243 5 5s-2.243 5-5 5-5-2.243-5-5 2.243-5 5-5m0-1a6 6 0 1 0 0 12A6 6 0 0 0 6 0m2.924 6.23c.101.018.101.166 0 .185-.953.181-3.022.556-3.273.556a.65.65 0 0 1-.65-.65c0-.256.384-2.724.562-3.723.017-.096.156-.09.172.007l.492 3.119z"></path></symbol></defs><defs><marker id="arrowhead" markerHeight="12" markerUnits="userSpaceOnUse" markerWidth="12" orient="auto-start-reverse" refX="7.9" refY="5"><path d="m-1 0 11 5-10 5z" style="fill:#d3d3d3;stroke:#d3d3d3"></path></marker></defs><defs><marker id="crosshead" markerHeight="8" markerWidth="15" orient="auto" refX="4" refY="4.5"><path stroke-width="1pt" d="m1 2 5 5m0-5L1 7" style="fill:#d3d3d3;stroke:#d3d3d3;stroke-dasharray:0,0"></path></marker></defs><defs><marker id="filled-head" markerHeight="28" markerWidth="20" orient="auto" refX="15.5" refY="7"><path d="m18 7-9 6 5-6-5-6Z"></path></marker></defs><defs><marker id="sequencenumber" markerHeight="40" markerWidth="60" orient="auto" refX="15" refY="15" style="fill:#d3d3d3"><circle cx="15" cy="15" r="6"></circle></marker></defs><text x="174" y="80" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Click &quot;Install App&quot;</text><line x1="76" x2="271" y1="109" y2="109" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line><text x="435" y="124" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Redirect với approval URL</text><line x1="276" x2="593" y1="153" y2="153" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line><text x="798" y="168" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Exchange authorization code cho access token</text><line x1="598" x2="997" y1="197" y2="197" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line><text x="801" y="212" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Return access token</text><line x1="1000" x2="601" y1="241" y2="241" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line><text x="438" y="256" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Redirect back với session</text><line x1="596" x2="279" y1="285" y2="285" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line><text x="435" y="300" alignment-baseline="middle" class="messageText" dominant-baseline="middle" dy="1em" style="font-family:arial,sans-serif;font-size:16px;font-weight:400" text-anchor="middle">Load app với authenticated session</text><line x1="276" x2="593" y1="329" y2="329" stroke-width="2" marker-end="url(#arrowhead)" class="messageLine0" style="fill:none"></line></svg></div>
<h3 id="chi-tiết-từng-bước">Chi tiết từng bước</h3>
<p><strong>1. Merchant click &quot;Install App&quot;</strong></p>
<pre><code>https://{shop}.myshopify.com/admin/apps/your-app
</code></pre>
<p><strong>2. Shopify redirect đến app với approval URL</strong></p>
<pre><code>https://your-app.com/auth?shop={shop}&amp;timestamp={timestamp}&amp;hmac={signature}
</code></pre>
<p><strong>3. App validate request và redirect đến OAuth screen</strong></p>
<pre><code>https://{shop}.myshopify.com/admin/oauth/authorize?
  client_id={api_key}
  &amp;scope={scopes}
  &amp;redirect_uri={your-app.com/auth/callback}
  &amp;state={nonce}
  &amp;response_type=code
</code></pre>
<p><strong>4. Merchant approve scopes</strong></p>
<p><strong>5. Shopify redirect với authorization code</strong></p>
<pre><code>https://your-app.com/auth/callback?
  shop={shop}
  &amp;code={authorization_code}
  &amp;state={nonce}
  &amp;hmac={signature}
</code></pre>
<p><strong>6. App exchange code cho access token</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> response</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#65BCFF"> fetch</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#86E1FC">  `</span><span style="color:#C3E88D">https://</span><span style="color:#86E1FC">${</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">}</span><span style="color:#C3E88D">.myshopify.com/admin/oauth/access_token</span><span style="color:#86E1FC">`</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  {</span></span>
<span data-line=""><span style="color:#4FD6BE">    method</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">POST</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    body</span><span style="color:#86E1FC">:</span><span style="color:#FF98A4"> JSON</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">stringify</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">      client_id</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> apiKey</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      client_secret</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> apiSecret</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">      code</span><span style="color:#86E1FC">:</span><span style="color:#C8D3F5"> authorizationCode</span></span>
<span data-line=""><span style="color:#B4C2F0">    })</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> access_token</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> response</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<p><strong>7. App lưu session và redirect merchant đến app UI</strong></p>
<hr/>
<h2 id="implementation-với-shopify-app-remix">Implementation với Shopify App Remix</h2>
<h3 id="shopifyserverts-configuration">shopify.server.ts Configuration</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">import</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-remix/adapters/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C8D3F5">  ApiVersion</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">  AppDistribution</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">  shopifyApp</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-remix/server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">RedisSessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-redis</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">PrismaSessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-prisma</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> shopify</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> shopifyApp</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_KEY</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiSecretKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_SECRET</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiVersion</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> ApiVersion</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">January25</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Scopes cần thiết</span></span>
<span data-line=""><span style="color:#4FD6BE">  scopes</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">    // Chỉ request scopes bạn cần</span></span>
<span data-line=""><span style="color:#4FD6BE">    default</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> [</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">write_products</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">read_themes</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">write_themes</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // App URL</span></span>
<span data-line=""><span style="color:#4FD6BE">  appUrl</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_APP_URL</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Authentication path</span></span>
<span data-line=""><span style="color:#4FD6BE">  authPathPrefix</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">/auth</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Session storage</span></span>
<span data-line=""><span style="color:#4FD6BE">  sessionStorage</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> RedisSessionStorage</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">    url</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">REDIS_URL</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    prefix</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shopify_app_sessions</span><span style="color:#86E1FC">&quot;</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Distribution (App Store hay Custom)</span></span>
<span data-line=""><span style="color:#4FD6BE">  distribution</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> AppDistribution</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">AppStore</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Hooks</span></span>
<span data-line=""><span style="color:#4FD6BE">  hooks</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">    // Sau khi merchant install app</span></span>
<span data-line=""><span style="color:#82AAFF">    afterAuth</span><span style="color:#86E1FC">:</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> admin</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> session</span><span style="color:#86E1FC"> }</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">      const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">      // Setup database records</span></span>
<span data-line=""><span style="color:#86E1FC">      await</span><span style="color:#65BCFF"> setupStore</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> admin</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">      // Sync initial data</span></span>
<span data-line=""><span style="color:#86E1FC">      await</span><span style="color:#65BCFF"> syncShopData</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> admin</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">      console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">log</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span><span style="color:#C3E88D">App installed for </span><span style="color:#86E1FC">${</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">}`</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Future features</span></span>
<span data-line=""><span style="color:#4FD6BE">  future</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    unstable_newEmbeddedAuthStrategy</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    removeRest</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#86E1FC"> default</span><span style="color:#C8D3F5"> shopify</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> authenticate</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> shopify</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">authenticate</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> unauthenticated</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> shopify</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">unauthenticated</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="session-storage-options">Session Storage Options</h3>
<p><strong>1. Redis (Recommended cho production)</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">RedisSessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-redis</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> sessionStorage</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> RedisSessionStorage</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  url</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">REDIS_URL</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  prefix</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">shopify_app_sessions</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#858AA6">  // Optional: Custom Redis instance</span></span>
<span data-line=""><span style="color:#858AA6">  // redis: redisClient</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<p><strong>2. MongoDB/Prisma</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">PrismaSessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-prisma</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> sessionStorage</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> PrismaSessionStorage</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">prisma</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<p><strong>3. Memory (Chỉ cho development)</strong></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">MemorySessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-memory</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> sessionStorage</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> MemorySessionStorage</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="scopes---quyền-truy-cập-app">Scopes - Quyền truy cập App</h2>
<h3 id="scopes-phổ-biến">Scopes phổ biến</h3>
<table><thead><tr><th>Scope</th><th>Mô tả</th><th>Use case</th></tr></thead><tbody><tr><td><code>write_products</code></td><td>Đọc/viết products</td><td>Product management apps</td></tr><tr><td><code>read_products</code></td><td>Đọc products</td><td>Analytics apps</td></tr><tr><td><code>write_orders</code></td><td>Đọc/viết orders</td><td>Order management</td></tr><tr><td><code>read_orders</code></td><td>Đọc orders</td><td>Reporting apps</td></tr><tr><td><code>write_customers</code></td><td>Đọc/viết customers</td><td>CRM apps</td></tr><tr><td><code>write_inventory</code></td><td>Quản lý inventory</td><td>Inventory apps</td></tr><tr><td><code>read_themes</code></td><td>Đọc theme files</td><td>Theme apps</td></tr><tr><td><code>write_themes</code></td><td>Ghi theme files</td><td>Apps inject code</td></tr><tr><td><code>write_script_tags</code></td><td>Thêm script tags</td><td>Apps inject JS</td></tr></tbody></table>
<h3 id="best-practices">Best Practices</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// ❌ BAD: Request quá nhiều scopes</span></span>
<span data-line=""><span style="color:#FFC777">scopes</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">write_products,write_orders,write_customers,write_inventory,write_script_tags</span><span style="color:#86E1FC">&quot;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">// ✅ GOOD: Chỉ request cần thiết</span></span>
<span data-line=""><span style="color:#FFC777">scopes</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">  default</span><span style="color:#B4C2F0">: </span><span style="color:#86E1FC">[</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">write_products</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">write_themes</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">],</span></span>
<span data-line=""><span style="color:#FFC777">  admin</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">write_orders</span><span style="color:#86E1FC">&quot;</span><span style="color:#858AA6">  // Chỉ cho admin users</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="sử-dụng-authentication-trong-routes">Sử dụng Authentication trong Routes</h2>
<h3 id="protected-routes-admin-ui">Protected Routes (Admin UI)</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/app._index.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">json</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> type</span><span style="color:#C8D3F5"> LoaderFunctionArgs</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">useLoaderData</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/react</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">authenticate</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../shopify.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">Card</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> Page</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/polaris</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> loader</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> LoaderFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // Authenticate và get session</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> admin</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">admin</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Session object chứa:</span></span>
<span data-line=""><span style="color:#858AA6">  // - session.shop: Shop domain</span></span>
<span data-line=""><span style="color:#858AA6">  // - session.accessToken: API access token</span></span>
<span data-line=""><span style="color:#858AA6">  // - session.scope: Granted scopes</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">  // Fetch data từ Shopify Admin API</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> response</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> admin</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">graphql</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span></span>
<span data-line=""><span style="color:#C3E88D">    query {</span></span>
<span data-line=""><span style="color:#C3E88D">      shop {</span></span>
<span data-line=""><span style="color:#C3E88D">        name</span></span>
<span data-line=""><span style="color:#C3E88D">        email</span></span>
<span data-line=""><span style="color:#C3E88D">        primaryDomain { url }</span></span>
<span data-line=""><span style="color:#C3E88D">      }</span></span>
<span data-line=""><span style="color:#C3E88D">    }</span></span>
<span data-line=""><span style="color:#86E1FC">  `</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> data</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> response</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">json</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#C8D3F5">    shop</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    shopData</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> data</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#86E1FC"> default</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> Index</span><span style="color:#B4C2F0">()</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shopData</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> useLoaderData</span><span style="color:#86E1FC">&lt;typeof</span><span style="color:#C8D3F5"> loader</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#B4C2F0"> (</span></span>
<span data-line=""><span style="color:#86E1FC">    &lt;</span><span style="color:#FFC777">Page</span><span style="color:#C099FF"> title</span><span style="color:#86E1FC">=</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Dashboard</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">      &lt;</span><span style="color:#FFC777">Card</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">        &lt;</span><span style="color:#FF757F">p</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Welcome to </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">shopData</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">name</span><span style="color:#86E1FC">}&lt;/</span><span style="color:#FF757F">p</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">        &lt;</span><span style="color:#FF757F">p</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0">Email: </span><span style="color:#86E1FC">{</span><span style="color:#FFC777">shopData</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">email</span><span style="color:#86E1FC">}&lt;/</span><span style="color:#FF757F">p</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">      &lt;/</span><span style="color:#FFC777">Card</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#86E1FC">    &lt;/</span><span style="color:#FFC777">Page</span><span style="color:#86E1FC">&gt;</span></span>
<span data-line=""><span style="color:#B4C2F0">  )</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="public-api-routes">Public API Routes</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/api.public.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">json</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> type</span><span style="color:#C8D3F5"> LoaderFunctionArgs</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">unauthenticated</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../shopify.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> loader</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> LoaderFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // Không cần authentication</span></span>
<span data-line=""><span style="color:#858AA6">  // Dùng cho webhooks, public endpoints</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">message</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">Public endpoint</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="webhook-authentication">Webhook Authentication</h2>
<p>Webhooks cần HMAC verification để đảm bảo request đến từ Shopify.</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="tsx" data-theme="moonlight-ii"><code data-language="tsx" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// app/routes/webhooks.app.uninstalled.tsx</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">json</span><span style="color:#86E1FC">,</span><span style="color:#86E1FC"> type</span><span style="color:#C8D3F5"> ActionFunctionArgs</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@remix-run/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">authenticate</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../shopify.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#82AAFF"> action</span><span style="color:#86E1FC"> =</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> request</span><span style="color:#86E1FC"> }:</span><span style="color:#FFC777"> ActionFunctionArgs</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#858AA6">  // authenticate.webhook tự động verify HMAC</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> topic</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> admin</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">webhook</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">topic</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">APP_UNINSTALLED</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#858AA6">    // Session = null cho uninstall webhook</span></span>
<span data-line=""><span style="color:#858AA6">    // Dùng shop domain để cleanup</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#65BCFF"> cleanupShopData</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">    return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#65BCFF"> json</span><span style="color:#B4C2F0">({ </span><span style="color:#4FD6BE">success</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> false</span><span style="color:#B4C2F0"> })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="security-best-practices">Security Best Practices</h2>
<h3 id="1-environment-variables">1. Environment Variables</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># .env</span></span>
<span data-line=""><span style="color:#C8D3F5">SHOPIFY_API_KEY</span><span style="color:#86E1FC">=</span><span style="color:#C3E88D">xxx</span></span>
<span data-line=""><span style="color:#C8D3F5">SHOPIFY_API_SECRET</span><span style="color:#86E1FC">=</span><span style="color:#C3E88D">xxx</span></span>
<span data-line=""><span style="color:#C8D3F5">SHOPIFY_APP_URL</span><span style="color:#86E1FC">=</span><span style="color:#C3E88D">https://your-app.com</span></span>
<span data-line=""><span style="color:#C8D3F5">REDIS_URL</span><span style="color:#86E1FC">=</span><span style="color:#C3E88D">redis://localhost:6379</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// shopify.server.ts</span></span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> shopify</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> shopifyApp</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_KEY</span><span style="color:#86E1FC">!,</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiSecretKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_SECRET</span><span style="color:#86E1FC">!,</span></span>
<span data-line=""><span style="color:#858AA6">  // ...</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<h3 id="2-https-cho-production">2. HTTPS cho Production</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Force HTTPS trong production</span></span>
<span data-line=""><span style="color:#86E1FC">if</span><span style="color:#B4C2F0"> (</span><span style="color:#FFC777">process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">NODE_ENV</span><span style="color:#86E1FC"> ===</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">production</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#FFC777">  app</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">use</span><span style="color:#B4C2F0">((</span><span style="color:#FCA7EA">req</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> res</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> next</span><span style="color:#B4C2F0">) </span><span style="color:#C099FF">=&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#86E1FC">    if</span><span style="color:#B4C2F0"> (</span><span style="color:#FFC777">req</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">header</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">x-forwarded-proto</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) </span><span style="color:#86E1FC">!==</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">https</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#FFC777">      res</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">redirect</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span><span style="color:#C3E88D">https://</span><span style="color:#86E1FC">${</span><span style="color:#FFC777">req</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">header</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">host</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">}${</span><span style="color:#FFC777">req</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">url</span><span style="color:#86E1FC">}`</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    } </span><span style="color:#86E1FC">else</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#65BCFF">      next</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span></span>
<span data-line=""><span style="color:#B4C2F0">  })</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="3-session-validation">3. Session Validation</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Middleware để validate session</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> requireShop</span><span style="color:#B4C2F0">(</span></span>
<span data-line=""><span style="color:#FCA7EA">  request</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Request</span></span>
<span data-line=""><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> Promise</span><span style="color:#86E1FC">&lt;</span><span style="color:#B4C2F0">{</span><span style="color:#4FD6BE"> shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#86E1FC">;</span><span style="color:#4FD6BE"> admin</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> AdminApiContext</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#86E1FC"> {</span><span style="color:#FF98A4"> session</span><span style="color:#86E1FC">,</span><span style="color:#FF98A4"> admin</span><span style="color:#86E1FC"> }</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> authenticate</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">admin</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">request</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">!</span><span style="color:#C8D3F5">session</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    throw</span><span style="color:#65BCFF"> redirect</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">/auth/login</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  return</span><span style="color:#B4C2F0"> { </span><span style="color:#4FD6BE">shop</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">,</span><span style="color:#C8D3F5"> admin</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<h3 id="4-rate-limiting">4. Rate Limiting</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Rate limit API calls</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">redis</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">../redis.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">async</span><span style="color:#C099FF"> function</span><span style="color:#82AAFF"> checkRateLimit</span><span style="color:#B4C2F0">(</span><span style="color:#FCA7EA">shop</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> string</span><span style="color:#B4C2F0">)</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> key</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> `</span><span style="color:#C3E88D">ratelimit:</span><span style="color:#86E1FC">${</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">}`</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#C099FF">  const</span><span style="color:#FF98A4"> count</span><span style="color:#86E1FC"> =</span><span style="color:#86E1FC"> await</span><span style="color:#FFC777"> redis</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">incr</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">key</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">count</span><span style="color:#86E1FC"> ===</span><span style="color:#FF966C"> 1</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    await</span><span style="color:#FFC777"> redis</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">expire</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">key</span><span style="color:#86E1FC">,</span><span style="color:#FF966C"> 60</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span><span style="color:#858AA6"> // 1 minute window</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">  if</span><span style="color:#B4C2F0"> (</span><span style="color:#C8D3F5">count</span><span style="color:#86E1FC"> &gt;</span><span style="color:#FF966C"> 100</span><span style="color:#B4C2F0">) {</span></span>
<span data-line=""><span style="color:#86E1FC">    throw</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> Error</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">Rate limit exceeded</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span></span></code></pre></figure>
<hr/>
<h2 id="real-world-example">Real-world Example</h2>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// shopify.server.ts từ sticky-add-to-cart</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-remix/adapters/node</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C8D3F5">  ApiVersion</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">  AppDistribution</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#C8D3F5">  shopifyApp</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">}</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-remix/server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">RedisSessionStorage</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">@shopify/shopify-app-session-storage-redis</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#B4C2F0"> { </span><span style="color:#C8D3F5">connectToMongoDB</span><span style="color:#B4C2F0"> }</span><span style="color:#86E1FC"> from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">./mongoose.server</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#FF98A4"> *</span><span style="color:#86E1FC"> as</span><span style="color:#C8D3F5"> configRepository </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">./repositories/config.repository</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">import</span><span style="color:#FF98A4"> *</span><span style="color:#86E1FC"> as</span><span style="color:#C8D3F5"> storeRepository </span><span style="color:#86E1FC">from</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">./repositories/store.repository</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#65BCFF">connectToMongoDB</span><span style="color:#B4C2F0">()</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#C099FF">const</span><span style="color:#FF98A4"> shopify</span><span style="color:#86E1FC"> =</span><span style="color:#65BCFF"> shopifyApp</span><span style="color:#B4C2F0">({</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_KEY</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiSecretKey</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_API_SECRET</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  apiVersion</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> ApiVersion</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">January25</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  scopes</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SCOPES</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">split</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">&quot;</span><span style="color:#C3E88D">,</span><span style="color:#86E1FC">&quot;</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  appUrl</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">SHOPIFY_APP_URL</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  authPathPrefix</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> &quot;</span><span style="color:#C3E88D">/auth</span><span style="color:#86E1FC">&quot;</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  sessionStorage</span><span style="color:#86E1FC">:</span><span style="color:#86E1FC"> new</span><span style="color:#65BCFF"> RedisSessionStorage</span><span style="color:#B4C2F0">(</span><span style="color:#FFC777">process</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">env</span><span style="color:#86E1FC">.</span><span style="color:#FF98A4">REDIS_URL</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  distribution</span><span style="color:#86E1FC">:</span><span style="color:#FFC777"> AppDistribution</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">AppStore</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  hooks</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#82AAFF">    afterAuth</span><span style="color:#86E1FC">:</span><span style="color:#C099FF"> async</span><span style="color:#B4C2F0"> (</span><span style="color:#86E1FC">{</span><span style="color:#FCA7EA"> admin</span><span style="color:#86E1FC">,</span><span style="color:#FCA7EA"> session</span><span style="color:#86E1FC"> }</span><span style="color:#B4C2F0">)</span><span style="color:#C099FF"> =&gt;</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#C099FF">      const</span><span style="color:#FF98A4"> shop</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> session</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">shop</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">      // Create store record nếu chưa có</span></span>
<span data-line=""><span style="color:#86E1FC">      await</span><span style="color:#FFC777"> storeRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOrCreate</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6">      // Create config record</span></span>
<span data-line=""><span style="color:#86E1FC">      await</span><span style="color:#FFC777"> configRepository</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">findOrCreate</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">shop</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#FFC777">      console</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">log</span><span style="color:#B4C2F0">(</span><span style="color:#86E1FC">`</span><span style="color:#C3E88D">Setup complete for </span><span style="color:#86E1FC">${</span><span style="color:#C8D3F5">shop</span><span style="color:#86E1FC">}`</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#B4C2F0">    }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">  future</span><span style="color:#86E1FC">:</span><span style="color:#B4C2F0"> {</span></span>
<span data-line=""><span style="color:#4FD6BE">    unstable_newEmbeddedAuthStrategy</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#4FD6BE">    removeRest</span><span style="color:#86E1FC">:</span><span style="color:#FF966C"> true</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">  }</span><span style="color:#86E1FC">,</span></span>
<span data-line=""><span style="color:#B4C2F0">})</span><span style="color:#86E1FC">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#86E1FC"> default</span><span style="color:#C8D3F5"> shopify</span><span style="color:#86E1FC">;</span></span>
<span data-line=""><span style="color:#86E1FC">export</span><span style="color:#C099FF"> const</span><span style="color:#FF98A4"> authenticate</span><span style="color:#86E1FC"> =</span><span style="color:#FFC777"> shopify</span><span style="color:#86E1FC">.</span><span style="color:#A9B8E8">authenticate</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="testing-authentication">Testing Authentication</h2>
<h3 id="test-với-development-store">Test với Development Store</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="bash" data-theme="moonlight-ii"><code data-language="bash" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6"># Start dev server</span></span>
<span data-line=""><span style="color:#FFC777">shopify</span><span style="color:#C3E88D"> app</span><span style="color:#C3E88D"> dev</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#858AA6"># CLI sẽ:</span></span>
<span data-line=""><span style="color:#858AA6"># 1. Start tunnel</span></span>
<span data-line=""><span style="color:#858AA6"># 2. Update app URL</span></span>
<span data-line=""><span style="color:#858AA6"># 3. Prompt for installation</span></span></code></pre></figure>
<h3 id="test-session-expiry">Test Session Expiry</h3>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#1F2028;color:#c8d3f5" tabindex="0" data-language="typescript" data-theme="moonlight-ii"><code data-language="typescript" data-theme="moonlight-ii" style="display:grid"><span data-line=""><span style="color:#858AA6">// Test session expiry manually</span></span>
<span data-line=""><span style="color:#86E1FC">await</span><span style="color:#FFC777"> sessionStorage</span><span style="color:#86E1FC">.</span><span style="color:#65BCFF">deleteSession</span><span style="color:#B4C2F0">(</span><span style="color:#C8D3F5">sessionId</span><span style="color:#B4C2F0">)</span><span style="color:#86E1FC">;</span></span></code></pre></figure>
<hr/>
<h2 id="common-issues">Common Issues</h2>
<h3 id="issue-invalid-hmac-signature">Issue: &quot;Invalid HMAC signature&quot;</h3>
<p><strong>Solution:</strong></p>
<ul>
<li>Verify API secret key</li>
<li>Check request parameters</li>
<li>Ensure timestamps are valid (5 minute window)</li>
</ul>
<h3 id="issue-session-not-found">Issue: &quot;Session not found&quot;</h3>
<p><strong>Solution:</strong></p>
<ul>
<li>Check Redis connection</li>
<li>Verify session storage configuration</li>
<li>Check session TTL settings</li>
</ul>
<h3 id="issue-access-denied">Issue: &quot;Access denied&quot;</h3>
<p><strong>Solution:</strong></p>
<ul>
<li>Verify scopes are requested</li>
<li>Check merchant approved all required scopes</li>
<li>Review API permissions in Partner Dashboard</li>
</ul>
<hr/>
<h2 id="key-takeaways">Key Takeaways</h2>
<ol>
<li><strong>OAuth flow</strong> bảo vệ app và xác thực merchant</li>
<li><strong>Session storage</strong> (Redis/MongoDB) lưu authentication state</li>
<li><strong>Scopes</strong> định nghĩa quyền truy cập - chỉ request cần thiết</li>
<li><strong>authenticate.admin()</strong> bảo vệ admin routes</li>
<li><strong>authenticate.webhook()</strong> verify webhook HMAC signatures</li>
</ol>
<hr/>
<h2 id="tài-nguyên-tham-khảo">Tài nguyên tham khảo</h2>
<ul>
<li><a href="https://shopify.dev/docs/apps/auth">Shopify OAuth Documentation</a></li>
<li><a href="https://shopify.dev/docs/apps/auth/session-tokens">Session Tokens</a></li>
<li><a href="https://shopify.dev/docs/api/alignment/access-scopes">API Scopes</a></li>
</ul>
<hr/>
<h2 id="next-steps">Next Steps</h2>
<p>Trong <strong>Phần 5</strong>, bạn sẽ học:</p>
<ul>
<li>Remix framework chi tiết</li>
<li>Shopify Polaris components</li>
<li>Xây dựng Admin UI</li>
<li>Loaders và Actions</li>
</ul>
<p><a href="/blog/xay-dung-admin-ui-remix-polaris">Đọc Phần 5: Xây dựng Admin UI với Remix và Polaris →</a></p>
<p><a href="/blog/tao-project-shopify-app-dau-tien">← Quay lại Phần 3: Tạo project đầu tiên</a></p></article></div><script src="/_next/static/chunks/webpack-82b2ba201d35e58a.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/5dfb718f68a2caf5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n4:I[8870,[\"637\",\"static/chunks/app/blog/shopify-app-authentication/page-c7afc5646a7bb2c5.js\"],\"MermaidZoom\"]\n6:I[9275,[],\"\"]\n7:I[1343,[],\"\"]\n8:I[231,[\"231\",\"static/chunks/231-f5a29f791931326e.js\",\"768\",\"static/chunks/app/blog/layout-a90c7b1536f7eb16.js\"],\"\"]\na:I[6130,[],\"\"]\n5:T325b,"])</script><script>self.__next_f.push([1,"m6.129 0 .128.003.128.002.126.004.126.005.124.006.124.008.123.008.12.009.121.01.12.012.118.012.116.013.116.014.114.016.113.016.111.017.11.018.109.019.106.02.106.02.104.021.102.023.101.023.099.024.097.025.095.026L9.18.4l.091.027.09.028.088.029.086.029.084.03.081.03.08.032.078.032.075.033.037.017.036.016.036.017.035.017.034.018.034.017.034.018.033.017.032.018.032.018.031.018.03.018.03.019.029.018.029.019.027.018.028.02.026.019.026.019.026.019.025.02.024.019.023.02.023.02.022.02.021.02.021.02.02.02.02.02.018.021.018.02.017.021.016.021.016.021.015.021.015.021.013.021.013.021.012.022.012.021.01.022.01.022.01.022.008.021.007.022.007.022.006.022.006.023.004.022.004.022.003.023.002.022v.023L11 1.75v8.523l-.001.022-.002.023-.003.022-.004.023-.004.022-.006.022-.006.022-.006.022-.008.022-.009.022-.009.022-.01.021-.01.022-.012.021-.012.022-.013.021-.013.021-.015.021-.015.021-.016.021-.016.021-.017.02-.018.021-.019.02-.019.021-.02.02-.02.02-.022.02-.022.02-.023.02-.023.02-.024.02-.025.019-.026.02-.026.019-.026.019-.028.019-.027.019-.029.018-.029.019-.03.018-.03.018-.031.018-.032.018-.032.018-.033.018-.034.017-.034.018-.034.017-.035.017-.036.017-.036.017-.037.016-.075.033-.078.032-.08.032-.081.03-.084.03-.086.03-.088.028-.09.028-.091.027-.094.027-.095.025-.097.025-.099.024-.1.023-.103.023-.104.021-.106.02-.107.02-.108.02-.11.018-.111.017-.113.016-.114.015-.116.014-.116.014-.118.012-.12.011-.12.01-.121.01-.123.008-.124.007-.124.006-.126.005-.126.004-.128.003-.128.002h-.258l-.128-.002-.127-.003-.127-.004-.125-.005-.125-.006-.123-.007-.123-.008-.121-.01-.121-.01-.119-.011-.118-.012-.117-.014-.115-.014-.114-.015-.113-.016-.112-.017-.11-.018-.108-.02-.107-.02-.106-.02-.104-.021-.102-.023-.1-.023-.1-.024-.097-.025-.095-.025-.094-.027-.092-.027-.089-.028-.088-.028-.086-.03-.084-.03-.082-.03-.079-.032-.078-.032-.075-.033-.037-.016-.036-.017-.036-.017-.035-.017-.035-.017-.034-.018-.033-.017-.033-.018-.032-.018-.032-.018-.03-.018-.031-.018-.03-.018-.029-.019-.029-.018-.028-.02-.027-.018-.027-.02-.026-.018-.025-.02-.025-.02-.024-.019-.023-.02-.023-.02-.022-.02-.021-.02-.021-.02-.02-.02-.02-.02-.018-.021-.018-.02-.017-.021-.016-.021-.016-.021-.015-.021-.015-.021-.013-.021-.013-.021-.012-.022-.012-.021-.01-.022-.01-.021-.01-.022-.008-.022-.007-.022-.007-.022-.006-.022-.005-.022-.005-.022-.003-.023-.003-.022-.002-.023L1 10.273 1 10.25V1.728l.002-.023.002-.022.003-.023.003-.022.005-.022.005-.023.006-.022.007-.022.007-.022.009-.021.009-.022.01-.022.01-.021.012-.022.012-.022.013-.021.013-.021.015-.021.015-.021.016-.021.016-.021.017-.02.018-.021.018-.02.02-.021.02-.02.02-.02.022-.02.022-.02.023-.02.023-.02.024-.02.025-.019.025-.02.026-.019.027-.019.027-.019.028-.019.029-.018.029-.019.03-.018.03-.018.031-.018.032-.018.032-.018.033-.018.033-.017.034-.017.035-.018.035-.017.036-.017.036-.016.037-.017.075-.033.078-.032.08-.031.081-.031.084-.03.086-.03.088-.028.09-.028L2.82.4l.094-.026.095-.026.098-.025.098-.024.101-.023.102-.023.104-.021.106-.02.107-.02.108-.02.11-.017.112-.017.113-.016.114-.016.115-.014.117-.013.118-.012.119-.012.12-.01.122-.01.123-.007.123-.008.125-.006.125-.005.127-.004.127-.002L5.871 0 6 0zM1.5 10.25v.015l.002.011.002.011.003.01.003.012.003.01.005.012.004.011.006.011.006.012.006.011.008.012.008.012.008.011.01.012.009.012.01.012.011.013.012.012.012.013.026.024.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.025.053.026.055.026.057.026.059.025.062.026.063.025.066.025.067.025.07.024.072.024.073.024.076.023.078.024.08.022.081.023.084.021.085.022.088.02.089.021.092.02.093.019.095.018.097.018.099.017.1.017.103.015.104.015.106.015.108.013.11.013.11.012.114.01.115.01.116.01.118.007.12.008.122.006.123.005.124.004.127.002.128.002L6 11.5h.13l.129-.003.127-.002.125-.004.123-.006.122-.006.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.013.108-.013.106-.014.105-.016.103-.015.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.025.066-.025.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.025.046-.027.044-.026.041-.025.04-.026.037-.026.035-.026.032-.025.03-.026.028-.025.026-.025.011-.012.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V8.187l-.038.027-.04.027-.042.027-.042.026-.044.026-.045.026-.046.026-.048.025-.048.025-.05.024-.051.025-.053.024-.053.023-.054.024-.056.023-.057.022-.057.023-.06.022-.06.021-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.019-.07.017-.07.018-.072.017-.072.016-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 9.028l-.08.012-.081.011-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.003-.091.003-.091.002-.092.001-.092.001h-.185l-.092-.001-.092-.001-.091-.002-.091-.003-.091-.003-.09-.004-.089-.004-.089-.005-.088-.005-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.011L4 9.028l-.08-.013-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.016-.071-.017-.071-.018-.07-.017-.068-.019-.068-.018-.067-.02-.066-.018-.065-.02-.064-.02-.063-.021-.062-.021-.061-.021-.06-.022-.059-.021-.058-.023-.056-.022-.056-.023-.055-.024-.053-.023-.052-.024-.051-.025-.05-.024-.049-.025-.047-.025-.047-.026-.045-.026-.043-.026-.043-.026-.041-.027-.04-.027-.039-.027zm0-2.827v.016l.002.01.002.011.003.011.003.011.003.011.005.011.004.011.006.012.006.011.006.012.008.012.008.011.008.012.01.012.009.012.01.012.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.053.026.055.025.057.026.059.026.062.025.063.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.022.085.021.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.011.115.01.116.009.118.008.12.007.122.006.123.005.124.004.127.003.128.001.129.001h.13l.129-.002.127-.003.125-.004.123-.005.122-.006.12-.008.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.025.063-.026.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.025.035-.026.032-.026.03-.025.028-.025.026-.025.011-.012.012-.012.01-.013.01-.012.01-.012.009-.012.008-.012.008-.011.007-.012.006-.012.006-.01.005-.012.005-.012.004-.01.003-.012.003-.01.002-.011.002-.011v-.01l.001-.011v-2.07l-.038.027-.04.027-.042.027-.042.026-.044.027-.045.025-.046.026-.048.025-.048.025-.05.025-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.018-.068.019-.069.018-.07.018-.07.017-.072.017-.072.016-.073.017-.074.015-.075.015-.076.015-.076.014-.077.014-.078.014-.08.013L8 6.194l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.008-.085.008-.087.008-.086.007-.088.006-.087.006-.089.006-.089.004-.09.005-.089.003-.09.004-.091.002-.091.002-.092.002-.092.001h-.185l-.092-.001-.092-.002-.091-.002-.091-.002-.091-.004-.09-.003-.089-.005-.089-.004-.088-.006-.088-.006L4.92 6.3l-.087-.007-.086-.008-.085-.008-.085-.008-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 6.194l-.08-.012-.078-.013-.078-.014-.077-.014-.077-.014-.075-.015-.075-.015-.074-.015-.073-.017-.073-.016-.071-.017-.071-.017-.07-.018-.068-.018-.068-.019-.067-.019-.066-.019-.065-.02-.064-.02-.063-.02-.062-.021-.061-.022-.06-.021-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.023-.052-.025-.051-.024-.05-.025-.049-.025-.047-.025-.047-.026-.045-.025-.043-.027-.043-.026-.041-.027-.04-.027-.039-.027zm0-2.833v.016l.002.01.002.011.003.011.003.01.003.012.005.011.004.011.006.012.006.011.006.012.008.011.008.012.008.012.01.011.009.012.01.013.011.012.012.012.012.012.026.025.028.025.03.025.033.026.035.025.038.026.04.026.041.026.044.026.046.026.049.026.051.026.053.025.055.026.057.026.059.025.062.026.063.025.066.025.067.025.07.024.072.024.073.024.076.024.078.023.08.022.081.023.084.021.085.022.088.021.089.02.092.02.093.019.095.018.097.018.099.017.1.017.103.016.104.015.106.014.108.013.11.013.11.012.114.01.115.01.116.01.118.008.12.007.122.006.123.005.124.004.127.003.128.001L6 5.84h.13l.129-.002.127-.003.125-.004.123-.005.122-.007.12-.007.119-.008.117-.009.115-.01.113-.01.112-.013.11-.012.108-.014.106-.014.105-.015.103-.016.1-.017.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.021.086-.022.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.024.066-.026.063-.025.061-.025.059-.026.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.025.032-.025.03-.026.028-.025.026-.025.011-.012.012-.013.01-.012.01-.012.01-.011.009-.012.008-.012.008-.012.007-.012.006-.011.006-.012.005-.011.005-.011.004-.011.003-.011.003-.011.002-.011.002-.011v-.01l.001-.011V2.514l-.038.027-.04.027-.042.026-.042.027-.044.026-.045.026-.046.025-.048.026-.048.025-.05.024-.051.024-.053.024-.053.024-.054.023-.056.023-.057.023-.057.022-.06.022-.06.022-.06.021-.062.021-.063.02-.064.02-.065.02-.066.02-.067.019-.068.018-.069.018-.07.018-.07.017-.072.017-.072.017-.073.016-.074.016-.075.015-.076.015-.076.014-.077.014-.078.013-.08.013L8 3.354l-.08.012-.081.012-.082.011-.082.01-.083.01-.084.01-.084.009-.085.009-.085.008-.087.007-.086.007-.088.007-.087.006-.089.005-.089.005-.09.004-.089.004-.09.002-.091.004-.091.002-.092.001h-.092L6 3.5h-.092l-.092-.001-.092-.001-.091-.003-.091-.002-.091-.003-.09-.004-.089-.004-.089-.006-.088-.004-.088-.006-.087-.007-.087-.007-.086-.007-.085-.008-.085-.009-.085-.009-.083-.01-.083-.01-.083-.01-.081-.011-.081-.012L4 3.354l-.08-.012-.078-.013-.078-.013-.077-.014-.077-.014-.075-.015-.075-.015-.074-.016-.073-.016-.073-.017-.071-.017-.071-.017-.07-.018-.068-.018-.068-.018-.067-.02-.066-.019-.065-.02-.064-.02-.063-.02L2.505 3l-.061-.021-.06-.022-.059-.022-.058-.022-.056-.023-.056-.023-.055-.023-.053-.024-.052-.024-.051-.024-.05-.025-.049-.024-.047-.026-.047-.025-.045-.026-.043-.026-.043-.027-.041-.026-.04-.027-.039-.027zM5.87.5l-.128.002-.127.003-.125.004-.124.005-.122.006-.12.007-.119.008-.116.01-.116.01-.113.011-.112.011-.11.013-.108.014-.106.014-.105.015-.102.016-.102.017-.099.017-.097.018-.095.019-.094.019-.091.02-.09.02L3.262.8l-.086.022-.084.021-.082.023-.08.023-.077.023-.076.024-.074.024-.072.024-.069.024-.068.025-.066.025-.063.026-.061.025-.059.026-.057.026-.055.026-.053.026-.05.026-.049.026-.046.026-.044.026-.041.026-.04.026-.037.025-.035.026-.032.026-.03.025-.028.025-.026.025-.011.012-.012.012-.01.012-.01.013-.01.012-.009.012-.008.011-.008.012-.007.012-.006.011-.006.012-.005.012-.005.01-.004.011-.003.012-.003.01-.002.011-.002.011v.01L1.5 1.75v.01l.001.011.002.01.002.011.003.011.003.011.004.011.005.011.005.012.006.011.006.012.007.011.008.012.008.012.01.012.009.012.01.012.01.012.012.012.011.013.026.025.028.025.03.025.032.025.035.026.037.026.04.026.041.026.044.026.046.026.048.026.051.026.053.026.055.026.057.026.059.025.061.026.063.025.066.025.068.025.07.025.071.024.074.024.076.024.077.023.08.023.082.022.084.022.086.021.087.021.09.021.091.02.094.019.095.019.097.018.1.017.1.016.103.016.105.016.106.014.108.013.11.013.112.012.113.011.116.01.116.01.119.007.12.007.122.006.124.006.125.004.127.002L5.87 3 6 3h.13l.129-.003.126-.002.125-.004.124-.006.122-.006.12-.007.119-.008.116-.009.116-.01.113-.011.112-.012.11-.013.108-.013.106-.014.105-.016.103-.016.1-.016.1-.017.097-.018.095-.019.094-.019.091-.02.09-.02.087-.022.086-.021.084-.022.082-.022.08-.023.077-.023.076-.024.074-.024.072-.024.069-.025.068-.025.066-.025.063-.025.061-.026.059-.025.057-.026.055-.026.053-.026.05-.026.049-.026.046-.026.044-.026.041-.026.04-.026.037-.026.035-.026.032-.025.03-.025.028-.025.026-.025.011-.013.012-.012.01-.012.01-.012.01-.012.009-.012.008-.012.008-.012.007-.011.006-.012.006-.011.005-.012.005-.01.004-.012.003-.011.003-.01.002-.012.002-.01v-.01l.001-.011v-.01l-.001-.011-.002-.01-.002-.012-.003-.01-.003-.011-.004-.011-.005-.011-.005-.012-.006-.011-.006-.012-.007-.011-.008-.013-.008-.011-.01-.012-.009-.012-.01-.013-.01-.012-.012-.012-.011-.012-.026-.025-.028-.025-.03-.025-.032-.025-.035-.026-.037-.026-.04-.026-.041-.026-.044-.026-.046-.026-.048-.026-.051-.026-.053-.026-.055-.026-.057-.026-.059-.026-.061-.025-.063-.026-.066-.025-.068-.025-.07-.024L9.298.96 9.223.936 9.147.912 9.07.889 8.99.866 8.907.843 8.824.822 8.738.8 8.651.78 8.56.758 8.47.739 8.376.72 8.281.701 8.182.683 8.086.666 7.983.649 7.882.633 7.776.618 7.67.604 7.562.59l-.11-.013L7.34.566 7.227.555l-.116-.01-.116-.01-.119-.008-.12-.007-.122-.006L6.51.51 6.385.505 6.259.502 6.13.5h-.26"])</script><script>self.__next_f.push([1,"b:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5dfb718f68a2caf5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"TGxWRb6e7ui63GHvPI7L9\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/shopify-app-authentication\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-app-authentication\",{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[\"shopify-app-authentication\",{\"children\":[\"__PAGE__\",{},[[\"$L3\",[[\"$\",\"nav\",null,{\"className\":\"toc\",\"children\":[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-1\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#giới-thiệu\",\"children\":\"Giới thiệu\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#shopify-oauth-flow\",\"children\":\"Shopify OAuth Flow\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#overview\",\"children\":\"Overview\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#chi-tiết-từng-bước\",\"children\":\"Chi tiết từng bước\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#implementation-với-shopify-app-remix\",\"children\":\"Implementation với Shopify App Remix\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#shopifyserverts-configuration\",\"children\":\"shopify.server.ts Configuration\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#session-storage-options\",\"children\":\"Session Storage Options\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#scopes---quyền-truy-cập-app\",\"children\":\"Scopes - Quyền truy cập App\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#scopes-phổ-biến\",\"children\":\"Scopes phổ biến\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#best-practices\",\"children\":\"Best Practices\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#sử-dụng-authentication-trong-routes\",\"children\":\"Sử dụng Authentication trong Routes\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#protected-routes-admin-ui\",\"children\":\"Protected Routes (Admin UI)\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#public-api-routes\",\"children\":\"Public API Routes\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#webhook-authentication\",\"children\":\"Webhook Authentication\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#security-best-practices\",\"children\":\"Security Best Practices\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#1-environment-variables\",\"children\":\"1. Environment Variables\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#2-https-cho-production\",\"children\":\"2. HTTPS cho Production\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#3-session-validation\",\"children\":\"3. Session Validation\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#4-rate-limiting\",\"children\":\"4. Rate Limiting\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#real-world-example\",\"children\":\"Real-world Example\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#testing-authentication\",\"children\":\"Testing Authentication\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#test-với-development-store\",\"children\":\"Test với Development Store\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#test-session-expiry\",\"children\":\"Test Session Expiry\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#common-issues\",\"children\":\"Common Issues\"}],[\"$\",\"ol\",null,{\"className\":\"toc-level toc-level-2\",\"children\":[[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#issue-invalid-hmac-signature\",\"children\":\"Issue: \\\"Invalid HMAC signature\\\"\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#issue-session-not-found\",\"children\":\"Issue: \\\"Session not found\\\"\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h3\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h3\",\"href\":\"#issue-access-denied\",\"children\":\"Issue: \\\"Access denied\\\"\"}]}]]}]]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#key-takeaways\",\"children\":\"Key Takeaways\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#tài-nguyên-tham-khảo\",\"children\":\"Tài nguyên tham khảo\"}]}],[\"$\",\"li\",null,{\"className\":\"toc-item toc-item-h2\",\"children\":[\"$\",\"a\",null,{\"className\":\"toc-link toc-link-h2\",\"href\":\"#next-steps\",\"children\":\"Next Steps\"}]}]]}]}],\"\\n\",[\"$\",\"h1\",null,{\"id\":\"authentication--authorization-trong-shopify-app\",\"children\":\"Authentication \u0026 Authorization trong Shopify App\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"giới-thiệu\",\"children\":\"Giới thiệu\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Authentication là hàng rào bảo vệ đầu tiên cho Shopify App của bạn. Bài viết này sẽ giải thích cách Shopify OAuth hoạt động và cách implement secure authentication.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"shopify-oauth-flow\",\"children\":\"Shopify OAuth Flow\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"overview\",\"children\":\"Overview\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Khi merchant cài đặt app của bạn, Shopify sẽ redirect họ qua app để xác thực quyền truy cập.\"}],\"\\n\",[\"$\",\"$L4\",null,{\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"id\":\"m05614617120579222-0\",\"width\":\"100%\",\"aria-roledescription\":\"sequence\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fill\":\"#ccc\",\"maxWidth\":\"1176px\"},\"viewBox\":\"-50 -10 1176 435\",\"children\":[[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"926\",\"y\":\"349\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-bottom\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"1001\",\"y\":\"381.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"1001\",\"dy\":\"0\",\"children\":\"Shopify API\"}]}],[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"522\",\"y\":\"349\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-bottom\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"597\",\"y\":\"381.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"597\",\"dy\":\"0\",\"children\":\"Your App\"}]}],[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"200\",\"y\":\"349\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-bottom\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"275\",\"y\":\"381.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"275\",\"dy\":\"0\",\"children\":\"Shopify Admin\"}]}],[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"y\":\"349\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-bottom\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"75\",\"y\":\"381.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"75\",\"dy\":\"0\",\"children\":\"Merchant\"}]}],[\"$\",\"line\",null,{\"id\":\"actor3\",\"x1\":\"1001\",\"x2\":\"1001\",\"y1\":\"65\",\"y2\":\"349\",\"stroke\":\"#999\",\"strokeWidth\":\".5\",\"className\":\"actor-line 200\"}],[\"$\",\"g\",null,{\"id\":\"root-3\",\"children\":[[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"926\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-top\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"1001\",\"y\":\"32.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"1001\",\"dy\":\"0\",\"children\":\"Shopify API\"}]}]]}],[\"$\",\"line\",null,{\"id\":\"actor2\",\"x1\":\"597\",\"x2\":\"597\",\"y1\":\"65\",\"y2\":\"349\",\"stroke\":\"#999\",\"strokeWidth\":\".5\",\"className\":\"actor-line 200\"}],[\"$\",\"g\",null,{\"id\":\"root-2\",\"children\":[[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"522\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-top\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"597\",\"y\":\"32.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"597\",\"dy\":\"0\",\"children\":\"Your App\"}]}]]}],[\"$\",\"line\",null,{\"id\":\"actor1\",\"x1\":\"275\",\"x2\":\"275\",\"y1\":\"65\",\"y2\":\"349\",\"stroke\":\"#999\",\"strokeWidth\":\".5\",\"className\":\"actor-line 200\"}],[\"$\",\"g\",null,{\"id\":\"root-1\",\"children\":[[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"x\":\"200\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-top\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"275\",\"y\":\"32.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"275\",\"dy\":\"0\",\"children\":\"Shopify Admin\"}]}]]}],[\"$\",\"line\",null,{\"id\":\"actor0\",\"x1\":\"75\",\"x2\":\"75\",\"y1\":\"65\",\"y2\":\"349\",\"stroke\":\"#999\",\"strokeWidth\":\".5\",\"className\":\"actor-line 200\"}],[\"$\",\"g\",null,{\"id\":\"root-0\",\"children\":[[\"$\",\"rect\",null,{\"width\":\"150\",\"height\":\"65\",\"fill\":\"#eaeaea\",\"stroke\":\"#666\",\"className\":\"actor actor-top\",\"rx\":\"3\",\"ry\":\"3\"}],[\"$\",\"text\",null,{\"x\":\"75\",\"y\":\"32.5\",\"alignmentBaseline\":\"central\",\"className\":\"actor actor-box\",\"dominantBaseline\":\"central\",\"style\":{\"textAnchor\":\"middle\",\"fontSize\":\"16px\",\"fontWeight\":\"400\",\"fontFamily\":\"arial,sans-serif\"},\"children\":[\"$\",\"tspan\",null,{\"x\":\"75\",\"dy\":\"0\",\"children\":\"Merchant\"}]}]]}],[\"$\",\"style\",null,{\"children\":\"@keyframes edge-animation-frame{0%{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#m05614617120579222-0 svg{font-family:arial,sans-serif;font-size:16px}#m05614617120579222-0 .actor{stroke:#ccc;fill:#1f2020}#m05614617120579222-0 text.actor\u003etspan{fill:#d3d3d3;stroke:none}#m05614617120579222-0 .actor-line{stroke:#ccc}#m05614617120579222-0 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#d3d3d3}#m05614617120579222-0 .messageText{fill:#d3d3d3;stroke:none}#m05614617120579222-0 line{stroke:#ccc;fill:#1f2020;stroke-width:2px}#m05614617120579222-0 :root{--mermaid-font-family:arial,sans-serif}\"}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"symbol\",null,{\"id\":\"computer\",\"children\":[\"$\",\"path\",null,{\"d\":\"M1 1v6.5h10V1zm9 5.5H2V2h8zm-5.114 3 .233-.5h1.762l.234.5zM12 11H0l1-3h1.052l-.665 2h9.225l-.648-2H11zM9.5 6h-7V2.5h7z\"}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"symbol\",null,{\"id\":\"database\",\"fillRule\":\"evenodd\",\"clipRule\":\"evenodd\",\"children\":[\"$\",\"path\",null,{\"d\":\"$5\"}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"symbol\",null,{\"id\":\"clock\",\"children\":[\"$\",\"path\",null,{\"d\":\"M6 1c2.757 0 5 2.243 5 5s-2.243 5-5 5-5-2.243-5-5 2.243-5 5-5m0-1a6 6 0 1 0 0 12A6 6 0 0 0 6 0m2.924 6.23c.101.018.101.166 0 .185-.953.181-3.022.556-3.273.556a.65.65 0 0 1-.65-.65c0-.256.384-2.724.562-3.723.017-.096.156-.09.172.007l.492 3.119z\"}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"marker\",null,{\"id\":\"arrowhead\",\"markerHeight\":\"12\",\"markerUnits\":\"userSpaceOnUse\",\"markerWidth\":\"12\",\"orient\":\"auto-start-reverse\",\"refX\":\"7.9\",\"refY\":\"5\",\"children\":[\"$\",\"path\",null,{\"d\":\"m-1 0 11 5-10 5z\",\"style\":{\"fill\":\"#d3d3d3\",\"stroke\":\"#d3d3d3\"}}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"marker\",null,{\"id\":\"crosshead\",\"markerHeight\":\"8\",\"markerWidth\":\"15\",\"orient\":\"auto\",\"refX\":\"4\",\"refY\":\"4.5\",\"children\":[\"$\",\"path\",null,{\"strokeWidth\":\"1pt\",\"d\":\"m1 2 5 5m0-5L1 7\",\"style\":{\"fill\":\"#d3d3d3\",\"stroke\":\"#d3d3d3\",\"strokeDasharray\":\"0,0\"}}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"marker\",null,{\"id\":\"filled-head\",\"markerHeight\":\"28\",\"markerWidth\":\"20\",\"orient\":\"auto\",\"refX\":\"15.5\",\"refY\":\"7\",\"children\":[\"$\",\"path\",null,{\"d\":\"m18 7-9 6 5-6-5-6Z\"}]}]}],[\"$\",\"defs\",null,{\"children\":[\"$\",\"marker\",null,{\"id\":\"sequencenumber\",\"markerHeight\":\"40\",\"markerWidth\":\"60\",\"orient\":\"auto\",\"refX\":\"15\",\"refY\":\"15\",\"style\":{\"fill\":\"#d3d3d3\"},\"children\":[\"$\",\"circle\",null,{\"cx\":\"15\",\"cy\":\"15\",\"r\":\"6\"}]}]}],[\"$\",\"text\",null,{\"x\":\"174\",\"y\":\"80\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Click \\\"Install App\\\"\"}],[\"$\",\"line\",null,{\"x1\":\"76\",\"x2\":\"271\",\"y1\":\"109\",\"y2\":\"109\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}],[\"$\",\"text\",null,{\"x\":\"435\",\"y\":\"124\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Redirect với approval URL\"}],[\"$\",\"line\",null,{\"x1\":\"276\",\"x2\":\"593\",\"y1\":\"153\",\"y2\":\"153\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}],[\"$\",\"text\",null,{\"x\":\"798\",\"y\":\"168\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Exchange authorization code cho access token\"}],[\"$\",\"line\",null,{\"x1\":\"598\",\"x2\":\"997\",\"y1\":\"197\",\"y2\":\"197\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}],[\"$\",\"text\",null,{\"x\":\"801\",\"y\":\"212\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Return access token\"}],[\"$\",\"line\",null,{\"x1\":\"1000\",\"x2\":\"601\",\"y1\":\"241\",\"y2\":\"241\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}],[\"$\",\"text\",null,{\"x\":\"438\",\"y\":\"256\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Redirect back với session\"}],[\"$\",\"line\",null,{\"x1\":\"596\",\"x2\":\"279\",\"y1\":\"285\",\"y2\":\"285\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}],[\"$\",\"text\",null,{\"x\":\"435\",\"y\":\"300\",\"alignmentBaseline\":\"middle\",\"className\":\"messageText\",\"dominantBaseline\":\"middle\",\"dy\":\"1em\",\"style\":{\"fontFamily\":\"arial,sans-serif\",\"fontSize\":\"16px\",\"fontWeight\":\"400\"},\"textAnchor\":\"middle\",\"children\":\"Load app với authenticated session\"}],[\"$\",\"line\",null,{\"x1\":\"276\",\"x2\":\"593\",\"y1\":\"329\",\"y2\":\"329\",\"strokeWidth\":\"2\",\"markerEnd\":\"url(#arrowhead)\",\"className\":\"messageLine0\",\"style\":{\"fill\":\"none\"}}]]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"chi-tiết-từng-bước\",\"children\":\"Chi tiết từng bước\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"1. Merchant click \\\"Install App\\\"\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://{shop}.myshopify.com/admin/apps/your-app\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"2. Shopify redirect đến app với approval URL\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://your-app.com/auth?shop={shop}\u0026timestamp={timestamp}\u0026hmac={signature}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"3. App validate request và redirect đến OAuth screen\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://{shop}.myshopify.com/admin/oauth/authorize?\\n  client_id={api_key}\\n  \u0026scope={scopes}\\n  \u0026redirect_uri={your-app.com/auth/callback}\\n  \u0026state={nonce}\\n  \u0026response_type=code\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"4. Merchant approve scopes\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"5. Shopify redirect với authorization code\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://your-app.com/auth/callback?\\n  shop={shop}\\n  \u0026code={authorization_code}\\n  \u0026state={nonce}\\n  \u0026hmac={signature}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"6. App exchange code cho access token\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" fetch\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  `\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"https://\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\".myshopify.com/admin/oauth/access_token\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    method\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"POST\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    body\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" JSON\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"stringify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      client_id\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" apiKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      client_secret\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" apiSecret\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"      code\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" authorizationCode\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    })\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" access_token\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"7. App lưu session và redirect merchant đến app UI\"}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"implementation-với-shopify-app-remix\",\"children\":\"Implementation với Shopify App Remix\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"shopifyserverts-configuration\",\"children\":\"shopify.server.ts Configuration\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-remix/adapters/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  ApiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  AppDistribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-remix/server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"PrismaSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-prisma\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiSecretKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ApiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"January25\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Scopes cần thiết\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  scopes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Chỉ request scopes bạn cần\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" [\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_products\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"read_themes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_themes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // App URL\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  appUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_APP_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Authentication path\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  authPathPrefix\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"/auth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Session storage\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"REDIS_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    prefix\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shopify_app_sessions\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Distribution (App Store hay Custom)\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  distribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" AppDistribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"AppStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Hooks\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Sau khi merchant install app\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\"    afterAuth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"      const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Setup database records\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" setupStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Sync initial data\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" syncShopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"      console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"App installed for \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Future features\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  future\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    unstable_newEmbeddedAuthStrategy\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    removeRest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" unauthenticated\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"unauthenticated\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"session-storage-options\",\"children\":\"Session Storage Options\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"1. Redis (Recommended cho production)\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"REDIS_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  prefix\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"shopify_app_sessions\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Optional: Custom Redis instance\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // redis: redisClient\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"2. MongoDB/Prisma\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"PrismaSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-prisma\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" PrismaSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"prisma\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"3. Memory (Chỉ cho development)\"}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"MemorySessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-memory\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" MemorySessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"scopes---quyền-truy-cập-app\",\"children\":\"Scopes - Quyền truy cập App\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"scopes-phổ-biến\",\"children\":\"Scopes phổ biến\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Scope\"}],[\"$\",\"th\",null,{\"children\":\"Mô tả\"}],[\"$\",\"th\",null,{\"children\":\"Use case\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_products\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc/viết products\"}],[\"$\",\"td\",null,{\"children\":\"Product management apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"read_products\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc products\"}],[\"$\",\"td\",null,{\"children\":\"Analytics apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_orders\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc/viết orders\"}],[\"$\",\"td\",null,{\"children\":\"Order management\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"read_orders\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc orders\"}],[\"$\",\"td\",null,{\"children\":\"Reporting apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_customers\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc/viết customers\"}],[\"$\",\"td\",null,{\"children\":\"CRM apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_inventory\"}]}],[\"$\",\"td\",null,{\"children\":\"Quản lý inventory\"}],[\"$\",\"td\",null,{\"children\":\"Inventory apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"read_themes\"}]}],[\"$\",\"td\",null,{\"children\":\"Đọc theme files\"}],[\"$\",\"td\",null,{\"children\":\"Theme apps\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_themes\"}]}],[\"$\",\"td\",null,{\"children\":\"Ghi theme files\"}],[\"$\",\"td\",null,{\"children\":\"Apps inject code\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"write_script_tags\"}]}],[\"$\",\"td\",null,{\"children\":\"Thêm script tags\"}],[\"$\",\"td\",null,{\"children\":\"Apps inject JS\"}]]}]]}]]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"best-practices\",\"children\":\"Best Practices\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ❌ BAD: Request quá nhiều scopes\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"scopes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_products,write_orders,write_customers,write_inventory,write_script_tags\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// ✅ GOOD: Chỉ request cần thiết\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"scopes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"[\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_products\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_themes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"],\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"write_orders\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Chỉ cho admin users\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"sử-dụng-authentication-trong-routes\",\"children\":\"Sử dụng Authentication trong Routes\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"protected-routes-admin-ui\",\"children\":\"Protected Routes (Admin UI)\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/app._index.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"useLoaderData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/react\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../shopify.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"Card\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/polaris\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Authenticate và get session\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Session object chứa:\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // - session.shop: Shop domain\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // - session.accessToken: API access token\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // - session.scope: Granted scopes\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Fetch data từ Shopify Admin API\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"graphql\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"    query {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      shop {\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        name\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        email\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"        primaryDomain { url }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"      }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  `\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" response\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"    shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    shopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" data\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" Index\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" useLoaderData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003ctypeof\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" title\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Dashboard\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Card\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"        \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Welcome to \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"name\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"        \u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"Email: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"email\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}\u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF757F\"},\"children\":\"p\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Card\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"Page\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  )\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"public-api-routes\",\"children\":\"Public API Routes\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/api.public.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"unauthenticated\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../shopify.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" loader\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" LoaderFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Không cần authentication\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // Dùng cho webhooks, public endpoints\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"message\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Public endpoint\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"webhook-authentication\",\"children\":\"Webhook Authentication\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Webhooks cần HMAC verification để đảm bảo request đến từ Shopify.\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"tsx\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// app/routes/webhooks.app.uninstalled.tsx\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" type\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@remix-run/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../shopify.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" action\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ActionFunctionArgs\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // authenticate.webhook tự động verify HMAC\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"webhook\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"APP_UNINSTALLED\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Session = null cho uninstall webhook\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"    // Dùng shop domain để cleanup\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" cleanupShopData\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" json\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({ \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"success\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" false\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"security-best-practices\",\"children\":\"Security Best Practices\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-environment-variables\",\"children\":\"1. Environment Variables\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# .env\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"SHOPIFY_API_KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"xxx\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"SHOPIFY_API_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"xxx\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"SHOPIFY_APP_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"https://your-app.com\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"REDIS_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"redis://localhost:6379\"}]]}]]}]}]}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// shopify.server.ts\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiSecretKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!,\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"  // ...\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-https-cho-production\",\"children\":\"2. HTTPS cho Production\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Force HTTPS trong production\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"NODE_ENV\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"production\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"  app\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"use\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"((\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" res\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" next\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"header\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"x-forwarded-proto\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!==\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"https\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"      res\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"redirect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"https://\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"header\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"host\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"req\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"url\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"else\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"      next\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  })\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-session-validation\",\"children\":\"3. Session Validation\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Middleware để validate session\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" requireShop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"  request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Request\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" Promise\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" AdminApiContext\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" {\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"request\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"!\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" redirect\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"/auth/login\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  return\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"4-rate-limiting\",\"children\":\"4. Rate Limiting\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Rate limit API calls\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"../redis.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" function\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\" checkRateLimit\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" string\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" key\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" `\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"ratelimit:\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"  const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"incr\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"key\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" ===\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 1\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"expire\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"key\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 60\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\" // 1 minute window\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"  if\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"count\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" 100\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\") {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"    throw\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" Error\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Rate limit exceeded\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"real-world-example\",\"children\":\"Real-world Example\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// shopify.server.ts từ sticky-add-to-cart\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-remix/adapters/node\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  ApiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  AppDistribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"  shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"}\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-remix/server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"@shopify/shopify-app-session-storage-redis\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" { \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"connectToMongoDB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"./mongoose.server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" *\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" configRepository \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"./repositories/config.repository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" *\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" as\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" storeRepository \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"./repositories/store.repository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"connectToMongoDB\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"()\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" shopifyApp\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_KEY\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiSecretKey\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_API_SECRET\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  apiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" ApiVersion\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"January25\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  scopes\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SCOPES\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"split\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  appUrl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"SHOPIFY_APP_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  authPathPrefix\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" \\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"/auth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\" RedisSessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"process\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"env\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\"REDIS_URL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  distribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" AppDistribution\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"AppStore\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  hooks\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#82AAFF\"},\"children\":\"    afterAuth\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" async\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" (\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" admin\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FCA7EA\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" =\u003e\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\"      const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" session\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Create store record nếu chưa có\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" storeRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOrCreate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"      // Create config record\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"      await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" configRepository\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"findOrCreate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"      console\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"log\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\"Setup complete for \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"$${\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"shop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"}`\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"    }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"  future\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    unstable_newEmbeddedAuthStrategy\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#4FD6BE\"},\"children\":\"    removeRest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\":\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF966C\"},\"children\":\" true\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"  }\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"})\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" default\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"export\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C099FF\"},\"children\":\" const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FF98A4\"},\"children\":\" authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\" =\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#A9B8E8\"},\"children\":\"authenticate\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"testing-authentication\",\"children\":\"Testing Authentication\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"test-với-development-store\",\"children\":\"Test với Development Store\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"bash\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# Start dev server\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\"shopify\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" app\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C3E88D\"},\"children\":\" dev\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# CLI sẽ:\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# 1. Start tunnel\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# 2. Update app URL\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"# 3. Prompt for installation\"}]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"test-session-expiry\",\"children\":\"Test Session Expiry\"}],\"\\n\",[\"$\",\"figure\",null,{\"className\":\"$undefined\",\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",null,{\"style\":{\"backgroundColor\":\"#1F2028\",\"color\":\"#c8d3f5\"},\"tabIndex\":\"0\",\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"children\":[\"$\",\"code\",null,{\"data-language\":\"typescript\",\"data-theme\":\"moonlight-ii\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#858AA6\"},\"children\":\"// Test session expiry manually\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\"await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FFC777\"},\"children\":\" sessionStorage\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\".\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#65BCFF\"},\"children\":\"deleteSession\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#C8D3F5\"},\"children\":\"sessionId\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B4C2F0\"},\"children\":\")\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#86E1FC\"},\"children\":\";\"}]]}]]}]}]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"common-issues\",\"children\":\"Common Issues\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"issue-invalid-hmac-signature\",\"children\":\"Issue: \\\"Invalid HMAC signature\\\"\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Solution:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Verify API secret key\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Check request parameters\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Ensure timestamps are valid (5 minute window)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"issue-session-not-found\",\"children\":\"Issue: \\\"Session not found\\\"\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Solution:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Check Redis connection\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Verify session storage configuration\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Check session TTL settings\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"issue-access-denied\",\"children\":\"Issue: \\\"Access denied\\\"\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Solution:\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Verify scopes are requested\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Check merchant approved all required scopes\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Review API permissions in Partner Dashboard\"}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"key-takeaways\",\"children\":\"Key Takeaways\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"OAuth flow\"}],\" bảo vệ app và xác thực merchant\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Session storage\"}],\" (Redis/MongoDB) lưu authentication state\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Scopes\"}],\" định nghĩa quyền truy cập - chỉ request cần thiết\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"authenticate.admin()\"}],\" bảo vệ admin routes\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"authenticate.webhook()\"}],\" verify webhook HMAC signatures\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"tài-nguyên-tham-khảo\",\"children\":\"Tài nguyên tham khảo\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://shopify.dev/docs/apps/auth\",\"children\":\"Shopify OAuth Documentation\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://shopify.dev/docs/apps/auth/session-tokens\",\"children\":\"Session Tokens\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://shopify.dev/docs/api/alignment/access-scopes\",\"children\":\"API Scopes\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"next-steps\",\"children\":\"Next Steps\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Trong \",[\"$\",\"strong\",null,{\"children\":\"Phần 5\"}],\", bạn sẽ học:\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Remix framework chi tiết\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Shopify Polaris components\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Xây dựng Admin UI\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Loaders và Actions\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/xay-dung-admin-ui-remix-polaris\",\"children\":\"Đọc Phần 5: Xây dựng Admin UI với Remix và Polaris →\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/blog/tao-project-shopify-app-dau-tien\",\"children\":\"← Quay lại Phần 3: Tạo project đầu tiên\"}]}]]],null],null]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"shopify-app-authentication\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"div\",null,{\"className\":\"\",\"children\":[[\"$\",\"$L8\",null,{\"href\":\"/\",\"className\":\"text-blue-500 hover:text-blue-700\",\"children\":\" Back to home\"}],[\"$\",\"article\",null,{\"className\":\"mt-4\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]}]]}],null],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/water.css@2/out/dark.css\"}]}],[\"$\",\"body\",null,{\"className\":\"antialiased max-w-screen-md mx-auto py-0 px-4 md:py-16\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L9\"],\"globalErrorComponent\":\"$a\",\"missingSlots\":\"$Wb\"}]]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Authentication \u0026 Authorization trong Shopify App - Hướng dẫn chi tiết\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Tìm hiểu về OAuth flow, session management, access tokens và securing Shopify App của bạn.\"}]]\n3:null\n"])</script></body></html>